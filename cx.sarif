{"$schema":"https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json","version":"2.1.0","runs":[{"tool":{"driver":{"name":"Checkmarx - SAST","organization":"Checkmarx - SAST","semanticVersion":"1.0.0","rules":[{"id":"Angular_Client_Stored_DOM_XSS","name":"Angular_Client_Stored_DOM_XSS_CX","shortDescription":{"text":"Angular_Client_Stored_DOM_XSS"},"fullDescription":{"text":"Angular_Client_Stored_DOM_XSS"},"help":{"text":"https://test4tools.cchaxcess.com/CxWebClient/ScanQueryDescription.aspx?queryID=5331&queryVersionCode=117568113&queryTitle=Angular_Client_Stored_DOM_XSS","markdown":"[Angular_Client_Stored_DOM_XSS Details](https://test4tools.cchaxcess.com/CxWebClient/ScanQueryDescription.aspx?queryID=5331&queryVersionCode=117568113&queryTitle=Angular_Client_Stored_DOM_XSS) <br />[Results](https://test4tools.cchaxcess.com/CxWebClient/ViewerMain.aspx?scanid=815120&projectid=16942&pathid=112)"},"properties":{"tags":["security","external/cwe/cwe-79"],"precision":"","security-severity":"7.0"}},{"id":"Client_Dynamic_File_Inclusion","name":"Client_Dynamic_File_Inclusion_CX","shortDescription":{"text":"Client_Dynamic_File_Inclusion"},"fullDescription":{"text":"Client_Dynamic_File_Inclusion"},"help":{"text":"https://test4tools.cchaxcess.com/CxWebClient/ScanQueryDescription.aspx?queryID=7522&queryVersionCode=153546527&queryTitle=Client_Dynamic_File_Inclusion","markdown":"[Client_Dynamic_File_Inclusion Details](https://test4tools.cchaxcess.com/CxWebClient/ScanQueryDescription.aspx?queryID=7522&queryVersionCode=153546527&queryTitle=Client_Dynamic_File_Inclusion) <br />[Results](https://test4tools.cchaxcess.com/CxWebClient/ViewerMain.aspx?scanid=815120&projectid=16942&pathid=139)"},"properties":{"tags":["security","external/cwe/cwe-829"],"precision":"","security-severity":"7.0"}},{"id":"Code_Injection","name":"Code_Injection_CX","shortDescription":{"text":"Code_Injection"},"fullDescription":{"text":"Code_Injection"},"help":{"text":"https://test4tools.cchaxcess.com/CxWebClient/ScanQueryDescription.aspx?queryID=2967&queryVersionCode=84152883&queryTitle=Code_Injection","markdown":"[Code_Injection Details](https://test4tools.cchaxcess.com/CxWebClient/ScanQueryDescription.aspx?queryID=2967&queryVersionCode=84152883&queryTitle=Code_Injection) <br />[Results](https://test4tools.cchaxcess.com/CxWebClient/ViewerMain.aspx?scanid=815120&projectid=16942&pathid=43)"},"properties":{"tags":["security","external/cwe/cwe-94"],"precision":"","security-severity":"7.0"}},{"id":"Deserialization_of_Untrusted_Data","name":"Deserialization_of_Untrusted_Data_CX","shortDescription":{"text":"Deserialization_of_Untrusted_Data"},"fullDescription":{"text":"Deserialization_of_Untrusted_Data"},"help":{"text":"https://test4tools.cchaxcess.com/CxWebClient/ScanQueryDescription.aspx?queryID=6090&queryVersionCode=129478187&queryTitle=Deserialization_of_Untrusted_Data","markdown":"[Deserialization_of_Untrusted_Data Details](https://test4tools.cchaxcess.com/CxWebClient/ScanQueryDescription.aspx?queryID=6090&queryVersionCode=129478187&queryTitle=Deserialization_of_Untrusted_Data) <br />[Results](https://test4tools.cchaxcess.com/CxWebClient/ViewerMain.aspx?scanid=815120&projectid=16942&pathid=114)"},"properties":{"tags":["security","external/cwe/cwe-502"],"precision":"","security-severity":"7.0"}},{"id":"Insecure_Storage_of_Sensitive_Data","name":"Insecure_Storage_of_Sensitive_Data_CX","shortDescription":{"text":"Insecure_Storage_of_Sensitive_Data"},"fullDescription":{"text":"Insecure_Storage_of_Sensitive_Data"},"help":{"text":"https://test4tools.cchaxcess.com/CxWebClient/ScanQueryDescription.aspx?queryID=6413&queryVersionCode=134809996&queryTitle=Insecure_Storage_of_Sensitive_Data","markdown":"[Insecure_Storage_of_Sensitive_Data Details](https://test4tools.cchaxcess.com/CxWebClient/ScanQueryDescription.aspx?queryID=6413&queryVersionCode=134809996&queryTitle=Insecure_Storage_of_Sensitive_Data) <br />[Results](https://test4tools.cchaxcess.com/CxWebClient/ViewerMain.aspx?scanid=815120&projectid=16942&pathid=123)"},"properties":{"tags":["security","external/cwe/cwe-933"],"precision":"","security-severity":"7.0"}},{"id":"JWT_No_Signature_Verification","name":"JWT_No_Signature_Verification_CX","shortDescription":{"text":"JWT_No_Signature_Verification"},"fullDescription":{"text":"JWT_No_Signature_Verification"},"help":{"text":"https://test4tools.cchaxcess.com/CxWebClient/ScanQueryDescription.aspx?queryID=6593&queryVersionCode=137698716&queryTitle=JWT_No_Signature_Verification","markdown":"[JWT_No_Signature_Verification Details](https://test4tools.cchaxcess.com/CxWebClient/ScanQueryDescription.aspx?queryID=6593&queryVersionCode=137698716&queryTitle=JWT_No_Signature_Verification) <br />[Results](https://test4tools.cchaxcess.com/CxWebClient/ViewerMain.aspx?scanid=815120&projectid=16942&pathid=129)"},"properties":{"tags":["security","external/cwe/cwe-287"],"precision":"","security-severity":"7.0"}},{"id":"Reflected_XSS","name":"Reflected_XSS_CX","shortDescription":{"text":"Reflected_XSS"},"fullDescription":{"text":"Reflected_XSS"},"help":{"text":"https://test4tools.cchaxcess.com/CxWebClient/ScanQueryDescription.aspx?queryID=2982&queryVersionCode=84412538&queryTitle=Reflected_XSS","markdown":"[Reflected_XSS Details](https://test4tools.cchaxcess.com/CxWebClient/ScanQueryDescription.aspx?queryID=2982&queryVersionCode=84412538&queryTitle=Reflected_XSS) <br />[Results](https://test4tools.cchaxcess.com/CxWebClient/ViewerMain.aspx?scanid=815120&projectid=16942&pathid=50)"},"properties":{"tags":["security","external/cwe/cwe-79"],"precision":"","security-severity":"7.0"}},{"id":"SQL_Injection","name":"SQL_Injection_CX","shortDescription":{"text":"SQL_Injection"},"fullDescription":{"text":"SQL_Injection"},"help":{"text":"https://test4tools.cchaxcess.com/CxWebClient/ScanQueryDescription.aspx?queryID=2984&queryVersionCode=84438525&queryTitle=SQL_Injection","markdown":"[SQL_Injection Details](https://test4tools.cchaxcess.com/CxWebClient/ScanQueryDescription.aspx?queryID=2984&queryVersionCode=84438525&queryTitle=SQL_Injection) <br />[Results](https://test4tools.cchaxcess.com/CxWebClient/ViewerMain.aspx?scanid=815120&projectid=16942&pathid=74)"},"properties":{"tags":["security","external/cwe/cwe-89"],"precision":"","security-severity":"7.0"}},{"id":"Stored_XSS","name":"Stored_XSS_CX","shortDescription":{"text":"Stored_XSS"},"fullDescription":{"text":"Stored_XSS"},"help":{"text":"https://test4tools.cchaxcess.com/CxWebClient/ScanQueryDescription.aspx?queryID=2987&queryVersionCode=84425527&queryTitle=Stored_XSS","markdown":"[Stored_XSS Details](https://test4tools.cchaxcess.com/CxWebClient/ScanQueryDescription.aspx?queryID=2987&queryVersionCode=84425527&queryTitle=Stored_XSS) <br />[Results](https://test4tools.cchaxcess.com/CxWebClient/ViewerMain.aspx?scanid=815120&projectid=16942&pathid=55)"},"properties":{"tags":["security","external/cwe/cwe-79"],"precision":"","security-severity":"7.0"}}],"informationUri":"https://checkmarx.com/"}},"results":[{"ruleId":"Stored_XSS","level":"error","message":{"text":"The method .then embeds untrusted data in generated output with json, at line 12 of data\\static\\codefixes\\dbSchemaChallenge_1.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by saving malicious data in a data-store ahead of time. The attacker's modified data is then read from the database by the .then method with CxArrayParam1, at line 6 of data\\static\\codefixes\\dbSchemaChallenge_1.ts. This untrusted data then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Stored Cross-Site Scripting (XSS) attack.Similarity ID: 422324413"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":0},"region":{"startLine":6,"endLine":6,"startColumn":14,"endColumn":27}},"message":{"text":".then(([products]: any) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":0},"region":{"startLine":6,"endLine":6,"startColumn":14,"endColumn":27}},"message":{"text":".then(([products]: any) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":0},"region":{"startLine":6,"endLine":6,"startColumn":15,"endColumn":23}},"message":{"text":".then(([products]: any) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":0},"region":{"startLine":12,"endLine":12,"startColumn":42,"endColumn":50}},"message":{"text":"res.json(utils.queryResultToJson(products))"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":0},"region":{"startLine":12,"endLine":12,"startColumn":24,"endColumn":41}},"message":{"text":"res.json(utils.queryResultToJson(products))"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":0},"region":{"startLine":12,"endLine":12,"startColumn":13,"endColumn":17}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":0},"region":{"startLine":6,"endLine":6,"startColumn":14,"endColumn":27}},"message":{"text":".then(([products]: any) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":0},"region":{"startLine":6,"endLine":6,"startColumn":14,"endColumn":27}},"message":{"text":".then(([products]: any) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":0},"region":{"startLine":6,"endLine":6,"startColumn":15,"endColumn":23}},"message":{"text":".then(([products]: any) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":0},"region":{"startLine":12,"endLine":12,"startColumn":42,"endColumn":50}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":0},"region":{"startLine":12,"endLine":12,"startColumn":24,"endColumn":41}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":0},"region":{"startLine":12,"endLine":12,"startColumn":13,"endColumn":17}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}}]}]}]},{"ruleId":"Stored_XSS","level":"error","message":{"text":"The method .then embeds untrusted data in generated output with json, at line 13 of data\\static\\codefixes\\unionSqlInjectionChallenge_1.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by saving malicious data in a data-store ahead of time. The attacker's modified data is then read from the database by the .then method with CxArrayParam1, at line 7 of data\\static\\codefixes\\unionSqlInjectionChallenge_1.ts. This untrusted data then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Stored Cross-Site Scripting (XSS) attack.Similarity ID: 1896174215"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":1},"region":{"startLine":7,"endLine":7,"startColumn":14,"endColumn":27}},"message":{"text":".then(([products]: any) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":1},"region":{"startLine":7,"endLine":7,"startColumn":14,"endColumn":27}},"message":{"text":".then(([products]: any) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":1},"region":{"startLine":7,"endLine":7,"startColumn":15,"endColumn":23}},"message":{"text":".then(([products]: any) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":1},"region":{"startLine":13,"endLine":13,"startColumn":42,"endColumn":50}},"message":{"text":"res.json(utils.queryResultToJson(products))"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":1},"region":{"startLine":13,"endLine":13,"startColumn":24,"endColumn":41}},"message":{"text":"res.json(utils.queryResultToJson(products))"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":1},"region":{"startLine":13,"endLine":13,"startColumn":13,"endColumn":17}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":1},"region":{"startLine":7,"endLine":7,"startColumn":14,"endColumn":27}},"message":{"text":".then(([products]: any) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":1},"region":{"startLine":7,"endLine":7,"startColumn":14,"endColumn":27}},"message":{"text":".then(([products]: any) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":1},"region":{"startLine":7,"endLine":7,"startColumn":15,"endColumn":23}},"message":{"text":".then(([products]: any) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":1},"region":{"startLine":13,"endLine":13,"startColumn":42,"endColumn":50}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":1},"region":{"startLine":13,"endLine":13,"startColumn":24,"endColumn":41}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":1},"region":{"startLine":13,"endLine":13,"startColumn":13,"endColumn":17}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}}]}]}]},{"ruleId":"Stored_XSS","level":"error","message":{"text":"The method ).then embeds untrusted data in generated output with json, at line 14 of data\\static\\codefixes\\dbSchemaChallenge_2_correct.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by saving malicious data in a data-store ahead of time. The attacker's modified data is then read from the database by the ).then method with CxArrayParam1, at line 8 of data\\static\\codefixes\\dbSchemaChallenge_2_correct.ts. This untrusted data then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Stored Cross-Site Scripting (XSS) attack.Similarity ID: 2067405376"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":2},"region":{"startLine":8,"endLine":8,"startColumn":15,"endColumn":28}},"message":{"text":").then(([products]: any) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":2},"region":{"startLine":8,"endLine":8,"startColumn":15,"endColumn":28}},"message":{"text":").then(([products]: any) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":2},"region":{"startLine":8,"endLine":8,"startColumn":16,"endColumn":24}},"message":{"text":").then(([products]: any) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":2},"region":{"startLine":14,"endLine":14,"startColumn":42,"endColumn":50}},"message":{"text":"res.json(utils.queryResultToJson(products))"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":2},"region":{"startLine":14,"endLine":14,"startColumn":24,"endColumn":41}},"message":{"text":"res.json(utils.queryResultToJson(products))"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":2},"region":{"startLine":14,"endLine":14,"startColumn":13,"endColumn":17}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":2},"region":{"startLine":8,"endLine":8,"startColumn":15,"endColumn":28}},"message":{"text":").then(([products]: any) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":2},"region":{"startLine":8,"endLine":8,"startColumn":15,"endColumn":28}},"message":{"text":").then(([products]: any) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":2},"region":{"startLine":8,"endLine":8,"startColumn":16,"endColumn":24}},"message":{"text":").then(([products]: any) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":2},"region":{"startLine":14,"endLine":14,"startColumn":42,"endColumn":50}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":2},"region":{"startLine":14,"endLine":14,"startColumn":24,"endColumn":41}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":2},"region":{"startLine":14,"endLine":14,"startColumn":13,"endColumn":17}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}}]}]}]},{"ruleId":"Stored_XSS","level":"error","message":{"text":"The method ).then embeds untrusted data in generated output with json, at line 14 of data\\static\\codefixes\\unionSqlInjectionChallenge_2_correct.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by saving malicious data in a data-store ahead of time. The attacker's modified data is then read from the database by the ).then method with CxArrayParam1, at line 8 of data\\static\\codefixes\\unionSqlInjectionChallenge_2_correct.ts. This untrusted data then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Stored Cross-Site Scripting (XSS) attack.Similarity ID: 360615758"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":3},"region":{"startLine":8,"endLine":8,"startColumn":15,"endColumn":28}},"message":{"text":").then(([products]: any) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":3},"region":{"startLine":8,"endLine":8,"startColumn":15,"endColumn":28}},"message":{"text":").then(([products]: any) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":3},"region":{"startLine":8,"endLine":8,"startColumn":16,"endColumn":24}},"message":{"text":").then(([products]: any) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":3},"region":{"startLine":14,"endLine":14,"startColumn":42,"endColumn":50}},"message":{"text":"res.json(utils.queryResultToJson(products))"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":3},"region":{"startLine":14,"endLine":14,"startColumn":24,"endColumn":41}},"message":{"text":"res.json(utils.queryResultToJson(products))"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":3},"region":{"startLine":14,"endLine":14,"startColumn":13,"endColumn":17}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":3},"region":{"startLine":8,"endLine":8,"startColumn":15,"endColumn":28}},"message":{"text":").then(([products]: any) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":3},"region":{"startLine":8,"endLine":8,"startColumn":15,"endColumn":28}},"message":{"text":").then(([products]: any) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":3},"region":{"startLine":8,"endLine":8,"startColumn":16,"endColumn":24}},"message":{"text":").then(([products]: any) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":3},"region":{"startLine":14,"endLine":14,"startColumn":42,"endColumn":50}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":3},"region":{"startLine":14,"endLine":14,"startColumn":24,"endColumn":41}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_2_correct.ts","uriBaseId":"%SRCROOT%","index":3},"region":{"startLine":14,"endLine":14,"startColumn":13,"endColumn":17}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}}]}]}]},{"ruleId":"Stored_XSS","level":"error","message":{"text":"The method .then embeds untrusted data in generated output with json, at line 17 of data\\static\\codefixes\\unionSqlInjectionChallenge_3.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by saving malicious data in a data-store ahead of time. The attacker's modified data is then read from the database by the .then method with CxArrayParam1, at line 11 of data\\static\\codefixes\\unionSqlInjectionChallenge_3.ts. This untrusted data then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Stored Cross-Site Scripting (XSS) attack.Similarity ID: -584104889"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":4},"region":{"startLine":11,"endLine":11,"startColumn":14,"endColumn":27}},"message":{"text":".then(([products]: any) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":4},"region":{"startLine":11,"endLine":11,"startColumn":14,"endColumn":27}},"message":{"text":".then(([products]: any) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":4},"region":{"startLine":11,"endLine":11,"startColumn":15,"endColumn":23}},"message":{"text":".then(([products]: any) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":4},"region":{"startLine":17,"endLine":17,"startColumn":42,"endColumn":50}},"message":{"text":"res.json(utils.queryResultToJson(products))"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":4},"region":{"startLine":17,"endLine":17,"startColumn":24,"endColumn":41}},"message":{"text":"res.json(utils.queryResultToJson(products))"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":4},"region":{"startLine":17,"endLine":17,"startColumn":13,"endColumn":17}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":4},"region":{"startLine":11,"endLine":11,"startColumn":14,"endColumn":27}},"message":{"text":".then(([products]: any) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":4},"region":{"startLine":11,"endLine":11,"startColumn":14,"endColumn":27}},"message":{"text":".then(([products]: any) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":4},"region":{"startLine":11,"endLine":11,"startColumn":15,"endColumn":23}},"message":{"text":".then(([products]: any) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":4},"region":{"startLine":17,"endLine":17,"startColumn":42,"endColumn":50}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":4},"region":{"startLine":17,"endLine":17,"startColumn":24,"endColumn":41}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":4},"region":{"startLine":17,"endLine":17,"startColumn":13,"endColumn":17}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}}]}]}]},{"ruleId":"Stored_XSS","level":"error","message":{"text":"The method .then embeds untrusted data in generated output with json, at line 18 of data\\static\\codefixes\\dbSchemaChallenge_3.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by saving malicious data in a data-store ahead of time. The attacker's modified data is then read from the database by the .then method with CxArrayParam1, at line 12 of data\\static\\codefixes\\dbSchemaChallenge_3.ts. This untrusted data then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Stored Cross-Site Scripting (XSS) attack.Similarity ID: 237992257"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":5},"region":{"startLine":12,"endLine":12,"startColumn":14,"endColumn":27}},"message":{"text":".then(([products]: any) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":5},"region":{"startLine":12,"endLine":12,"startColumn":14,"endColumn":27}},"message":{"text":".then(([products]: any) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":5},"region":{"startLine":12,"endLine":12,"startColumn":15,"endColumn":23}},"message":{"text":".then(([products]: any) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":5},"region":{"startLine":18,"endLine":18,"startColumn":42,"endColumn":50}},"message":{"text":"res.json(utils.queryResultToJson(products))"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":5},"region":{"startLine":18,"endLine":18,"startColumn":24,"endColumn":41}},"message":{"text":"res.json(utils.queryResultToJson(products))"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":5},"region":{"startLine":18,"endLine":18,"startColumn":13,"endColumn":17}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":5},"region":{"startLine":12,"endLine":12,"startColumn":14,"endColumn":27}},"message":{"text":".then(([products]: any) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":5},"region":{"startLine":12,"endLine":12,"startColumn":14,"endColumn":27}},"message":{"text":".then(([products]: any) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":5},"region":{"startLine":12,"endLine":12,"startColumn":15,"endColumn":23}},"message":{"text":".then(([products]: any) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":5},"region":{"startLine":18,"endLine":18,"startColumn":42,"endColumn":50}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":5},"region":{"startLine":18,"endLine":18,"startColumn":24,"endColumn":41}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":5},"region":{"startLine":18,"endLine":18,"startColumn":13,"endColumn":17}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}}]}]}]},{"ruleId":"Stored_XSS","level":"error","message":{"text":"The method .then embeds untrusted data in generated output with json, at line 68 of routes\\search.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by saving malicious data in a data-store ahead of time. The attacker's modified data is then read from the database by the .then method with CxArrayParam1, at line 24 of routes\\search.ts. This untrusted data then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Stored Cross-Site Scripting (XSS) attack.Similarity ID: 1173876839"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":6},"region":{"startLine":24,"endLine":24,"startColumn":14,"endColumn":27}},"message":{"text":".then(([products]: any) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":6},"region":{"startLine":24,"endLine":24,"startColumn":14,"endColumn":27}},"message":{"text":".then(([products]: any) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":6},"region":{"startLine":24,"endLine":24,"startColumn":15,"endColumn":23}},"message":{"text":".then(([products]: any) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":6},"region":{"startLine":68,"endLine":68,"startColumn":42,"endColumn":50}},"message":{"text":"res.json(utils.queryResultToJson(products))"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":6},"region":{"startLine":68,"endLine":68,"startColumn":24,"endColumn":41}},"message":{"text":"res.json(utils.queryResultToJson(products))"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":6},"region":{"startLine":68,"endLine":68,"startColumn":13,"endColumn":17}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":6},"region":{"startLine":24,"endLine":24,"startColumn":14,"endColumn":27}},"message":{"text":".then(([products]: any) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":6},"region":{"startLine":24,"endLine":24,"startColumn":14,"endColumn":27}},"message":{"text":".then(([products]: any) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":6},"region":{"startLine":24,"endLine":24,"startColumn":15,"endColumn":23}},"message":{"text":".then(([products]: any) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":6},"region":{"startLine":68,"endLine":68,"startColumn":42,"endColumn":50}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":6},"region":{"startLine":68,"endLine":68,"startColumn":24,"endColumn":41}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":6},"region":{"startLine":68,"endLine":68,"startColumn":13,"endColumn":17}},"message":{"text":"res.json(utils.queryResultToJson(products))"}}}]}]}]},{"ruleId":"Stored_XSS","level":"error","message":{"text":"The method .then embeds untrusted data in generated output with json, at line 24 of data\\static\\codefixes\\loginJimChallenge_4.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by saving malicious data in a data-store ahead of time. The attacker's modified data is then read from the database by the .then method with authenticatedUser, at line 21 of data\\static\\codefixes\\loginJimChallenge_4.ts. This untrusted data then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Stored Cross-Site Scripting (XSS) attack.Similarity ID: 1945572631\r\n\r\nThe method .then embeds untrusted data in generated output with json, at line 10 of data\\static\\codefixes\\loginJimChallenge_4.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by saving malicious data in a data-store ahead of time. The attacker's modified data is then read from the database by the .then method with authenticatedUser, at line 21 of data\\static\\codefixes\\loginJimChallenge_4.ts. This untrusted data then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Stored Cross-Site Scripting (XSS) attack.Similarity ID: 1688030036"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":21,"endLine":21,"startColumn":14,"endColumn":31}},"message":{"text":".then((authenticatedUser: { data: User }) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":22,"endLine":22,"startColumn":46,"endColumn":63}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":22,"endLine":22,"startColumn":28,"endColumn":45}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":22,"endLine":22,"startColumn":15,"endColumn":19}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":28,"endLine":28,"startColumn":25,"endColumn":29}},"message":{"text":"userId: user.data.id,"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":28,"endLine":28,"startColumn":30,"endColumn":34}},"message":{"text":"userId: user.data.id,"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":28,"endLine":28,"startColumn":35,"endColumn":37}},"message":{"text":"userId: user.data.id,"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":28,"endLine":28,"startColumn":23,"endColumn":24}},"message":{"text":"userId: user.data.id,"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":27,"endLine":27,"startColumn":34,"endColumn":43}},"message":{"text":"tmpToken: security.authorize({"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":27,"endLine":27,"startColumn":23,"endColumn":24}},"message":{"text":"tmpToken: security.authorize({"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":26,"endLine":26,"startColumn":17,"endColumn":18}},"message":{"text":"data: {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":24,"endLine":24,"startColumn":27,"endColumn":31}},"message":{"text":"res.status(401).json({"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":21,"endLine":21,"startColumn":14,"endColumn":31}},"message":{"text":".then((authenticatedUser: { data: User }) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":22,"endLine":22,"startColumn":46,"endColumn":63}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":22,"endLine":22,"startColumn":28,"endColumn":45}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":22,"endLine":22,"startColumn":15,"endColumn":19}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":34,"endLine":34,"startColumn":22,"endColumn":26}},"message":{"text":"afterLogin(user, res, next)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":4,"endLine":4,"startColumn":24,"endColumn":28}},"message":{"text":"function afterLogin (user: { data: User, bid: number }, res: Response, next: NextFunction) {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":6,"endLine":6,"startColumn":48,"endColumn":50}},"message":{"text":".then(([basket]: [BasketModel, boolean]) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":8,"endLine":8,"startColumn":9,"endColumn":13}},"message":{"text":"user.bid = basket.id // keep track of original basket"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":10,"endLine":10,"startColumn":68,"endColumn":72}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":10,"endLine":10,"startColumn":73,"endColumn":77}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":10,"endLine":10,"startColumn":78,"endColumn":83}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":10,"endLine":10,"startColumn":66,"endColumn":67}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":10,"endLine":10,"startColumn":34,"endColumn":35}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":10,"endLine":10,"startColumn":13,"endColumn":17}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":21,"endLine":21,"startColumn":14,"endColumn":31}},"message":{"text":".then((authenticatedUser: { data: User }) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":22,"endLine":22,"startColumn":46,"endColumn":63}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":22,"endLine":22,"startColumn":28,"endColumn":45}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":22,"endLine":22,"startColumn":15,"endColumn":19}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":28,"endLine":28,"startColumn":25,"endColumn":29}},"message":{"text":"userId: user.data.id,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":28,"endLine":28,"startColumn":30,"endColumn":34}},"message":{"text":"userId: user.data.id,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":28,"endLine":28,"startColumn":35,"endColumn":37}},"message":{"text":"userId: user.data.id,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":28,"endLine":28,"startColumn":23,"endColumn":24}},"message":{"text":"userId: user.data.id,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":27,"endLine":27,"startColumn":34,"endColumn":43}},"message":{"text":"tmpToken: security.authorize({"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":27,"endLine":27,"startColumn":23,"endColumn":24}},"message":{"text":"tmpToken: security.authorize({"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":26,"endLine":26,"startColumn":17,"endColumn":18}},"message":{"text":"data: {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":24,"endLine":24,"startColumn":27,"endColumn":31}},"message":{"text":"res.status(401).json({"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":21,"endLine":21,"startColumn":14,"endColumn":31}},"message":{"text":".then((authenticatedUser: { data: User }) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":22,"endLine":22,"startColumn":46,"endColumn":63}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":22,"endLine":22,"startColumn":28,"endColumn":45}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":22,"endLine":22,"startColumn":15,"endColumn":19}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":34,"endLine":34,"startColumn":22,"endColumn":26}},"message":{"text":"afterLogin(user, res, next)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":4,"endLine":4,"startColumn":24,"endColumn":28}},"message":{"text":"function afterLogin (user: { data: User, bid: number }, res: Response, next: NextFunction) {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":6,"endLine":6,"startColumn":48,"endColumn":50}},"message":{"text":".then(([basket]: [BasketModel, boolean]) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":8,"endLine":8,"startColumn":9,"endColumn":13}},"message":{"text":"user.bid = basket.id // keep track of original basket"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":10,"endLine":10,"startColumn":68,"endColumn":72}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":10,"endLine":10,"startColumn":73,"endColumn":77}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":10,"endLine":10,"startColumn":78,"endColumn":83}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":10,"endLine":10,"startColumn":66,"endColumn":67}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":10,"endLine":10,"startColumn":34,"endColumn":35}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":7},"region":{"startLine":10,"endLine":10,"startColumn":13,"endColumn":17}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}}]}]}]},{"ruleId":"Stored_XSS","level":"error","message":{"text":"The method .then embeds untrusted data in generated output with json, at line 24 of data\\static\\codefixes\\loginAdminChallenge_1.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by saving malicious data in a data-store ahead of time. The attacker's modified data is then read from the database by the .then method with authenticatedUser, at line 21 of data\\static\\codefixes\\loginAdminChallenge_1.ts. This untrusted data then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Stored Cross-Site Scripting (XSS) attack.Similarity ID: 1476524367\r\n\r\nThe method .then embeds untrusted data in generated output with json, at line 10 of data\\static\\codefixes\\loginAdminChallenge_1.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by saving malicious data in a data-store ahead of time. The attacker's modified data is then read from the database by the .then method with authenticatedUser, at line 21 of data\\static\\codefixes\\loginAdminChallenge_1.ts. This untrusted data then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Stored Cross-Site Scripting (XSS) attack.Similarity ID: 631020060"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":21,"endLine":21,"startColumn":14,"endColumn":31}},"message":{"text":".then((authenticatedUser: { data: User }) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":22,"endLine":22,"startColumn":46,"endColumn":63}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":22,"endLine":22,"startColumn":28,"endColumn":45}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":22,"endLine":22,"startColumn":15,"endColumn":19}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":28,"endLine":28,"startColumn":25,"endColumn":29}},"message":{"text":"userId: user.data.id,"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":28,"endLine":28,"startColumn":30,"endColumn":34}},"message":{"text":"userId: user.data.id,"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":28,"endLine":28,"startColumn":35,"endColumn":37}},"message":{"text":"userId: user.data.id,"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":28,"endLine":28,"startColumn":23,"endColumn":24}},"message":{"text":"userId: user.data.id,"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":27,"endLine":27,"startColumn":34,"endColumn":43}},"message":{"text":"tmpToken: security.authorize({"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":27,"endLine":27,"startColumn":23,"endColumn":24}},"message":{"text":"tmpToken: security.authorize({"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":26,"endLine":26,"startColumn":17,"endColumn":18}},"message":{"text":"data: {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":24,"endLine":24,"startColumn":27,"endColumn":31}},"message":{"text":"res.status(401).json({"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":21,"endLine":21,"startColumn":14,"endColumn":31}},"message":{"text":".then((authenticatedUser: { data: User }) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":22,"endLine":22,"startColumn":46,"endColumn":63}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":22,"endLine":22,"startColumn":28,"endColumn":45}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":22,"endLine":22,"startColumn":15,"endColumn":19}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":34,"endLine":34,"startColumn":22,"endColumn":26}},"message":{"text":"afterLogin(user, res, next)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":4,"endLine":4,"startColumn":24,"endColumn":28}},"message":{"text":"function afterLogin (user: { data: User, bid: number }, res: Response, next: NextFunction) {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":6,"endLine":6,"startColumn":48,"endColumn":50}},"message":{"text":".then(([basket]: [BasketModel, boolean]) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":8,"endLine":8,"startColumn":9,"endColumn":13}},"message":{"text":"user.bid = basket.id // keep track of original basket"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":10,"endLine":10,"startColumn":68,"endColumn":72}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":10,"endLine":10,"startColumn":73,"endColumn":77}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":10,"endLine":10,"startColumn":78,"endColumn":83}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":10,"endLine":10,"startColumn":66,"endColumn":67}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":10,"endLine":10,"startColumn":34,"endColumn":35}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":10,"endLine":10,"startColumn":13,"endColumn":17}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":21,"endLine":21,"startColumn":14,"endColumn":31}},"message":{"text":".then((authenticatedUser: { data: User }) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":22,"endLine":22,"startColumn":46,"endColumn":63}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":22,"endLine":22,"startColumn":28,"endColumn":45}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":22,"endLine":22,"startColumn":15,"endColumn":19}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":28,"endLine":28,"startColumn":25,"endColumn":29}},"message":{"text":"userId: user.data.id,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":28,"endLine":28,"startColumn":30,"endColumn":34}},"message":{"text":"userId: user.data.id,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":28,"endLine":28,"startColumn":35,"endColumn":37}},"message":{"text":"userId: user.data.id,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":28,"endLine":28,"startColumn":23,"endColumn":24}},"message":{"text":"userId: user.data.id,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":27,"endLine":27,"startColumn":34,"endColumn":43}},"message":{"text":"tmpToken: security.authorize({"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":27,"endLine":27,"startColumn":23,"endColumn":24}},"message":{"text":"tmpToken: security.authorize({"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":26,"endLine":26,"startColumn":17,"endColumn":18}},"message":{"text":"data: {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":24,"endLine":24,"startColumn":27,"endColumn":31}},"message":{"text":"res.status(401).json({"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":21,"endLine":21,"startColumn":14,"endColumn":31}},"message":{"text":".then((authenticatedUser: { data: User }) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":22,"endLine":22,"startColumn":46,"endColumn":63}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":22,"endLine":22,"startColumn":28,"endColumn":45}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":22,"endLine":22,"startColumn":15,"endColumn":19}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":34,"endLine":34,"startColumn":22,"endColumn":26}},"message":{"text":"afterLogin(user, res, next)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":4,"endLine":4,"startColumn":24,"endColumn":28}},"message":{"text":"function afterLogin (user: { data: User, bid: number }, res: Response, next: NextFunction) {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":6,"endLine":6,"startColumn":48,"endColumn":50}},"message":{"text":".then(([basket]: [BasketModel, boolean]) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":8,"endLine":8,"startColumn":9,"endColumn":13}},"message":{"text":"user.bid = basket.id // keep track of original basket"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":10,"endLine":10,"startColumn":68,"endColumn":72}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":10,"endLine":10,"startColumn":73,"endColumn":77}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":10,"endLine":10,"startColumn":78,"endColumn":83}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":10,"endLine":10,"startColumn":66,"endColumn":67}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":10,"endLine":10,"startColumn":34,"endColumn":35}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":8},"region":{"startLine":10,"endLine":10,"startColumn":13,"endColumn":17}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}}]}]}]},{"ruleId":"Stored_XSS","level":"error","message":{"text":"The method .then embeds untrusted data in generated output with json, at line 24 of data\\static\\codefixes\\loginBenderChallenge_1.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by saving malicious data in a data-store ahead of time. The attacker's modified data is then read from the database by the .then method with authenticatedUser, at line 21 of data\\static\\codefixes\\loginBenderChallenge_1.ts. This untrusted data then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Stored Cross-Site Scripting (XSS) attack.Similarity ID: 468757531\r\n\r\nThe method .then embeds untrusted data in generated output with json, at line 10 of data\\static\\codefixes\\loginBenderChallenge_1.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by saving malicious data in a data-store ahead of time. The attacker's modified data is then read from the database by the .then method with authenticatedUser, at line 21 of data\\static\\codefixes\\loginBenderChallenge_1.ts. This untrusted data then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Stored Cross-Site Scripting (XSS) attack.Similarity ID: -429781296"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":21,"endLine":21,"startColumn":14,"endColumn":31}},"message":{"text":".then((authenticatedUser: { data: User }) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":22,"endLine":22,"startColumn":46,"endColumn":63}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":22,"endLine":22,"startColumn":28,"endColumn":45}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":22,"endLine":22,"startColumn":15,"endColumn":19}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":28,"endLine":28,"startColumn":25,"endColumn":29}},"message":{"text":"userId: user.data.id,"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":28,"endLine":28,"startColumn":30,"endColumn":34}},"message":{"text":"userId: user.data.id,"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":28,"endLine":28,"startColumn":35,"endColumn":37}},"message":{"text":"userId: user.data.id,"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":28,"endLine":28,"startColumn":23,"endColumn":24}},"message":{"text":"userId: user.data.id,"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":27,"endLine":27,"startColumn":34,"endColumn":43}},"message":{"text":"tmpToken: security.authorize({"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":27,"endLine":27,"startColumn":23,"endColumn":24}},"message":{"text":"tmpToken: security.authorize({"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":26,"endLine":26,"startColumn":17,"endColumn":18}},"message":{"text":"data: {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":24,"endLine":24,"startColumn":27,"endColumn":31}},"message":{"text":"res.status(401).json({"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":21,"endLine":21,"startColumn":14,"endColumn":31}},"message":{"text":".then((authenticatedUser: { data: User }) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":22,"endLine":22,"startColumn":46,"endColumn":63}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":22,"endLine":22,"startColumn":28,"endColumn":45}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":22,"endLine":22,"startColumn":15,"endColumn":19}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":34,"endLine":34,"startColumn":22,"endColumn":26}},"message":{"text":"afterLogin(user, res, next)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":4,"endLine":4,"startColumn":24,"endColumn":28}},"message":{"text":"function afterLogin (user: { data: User, bid: number }, res: Response, next: NextFunction) {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":6,"endLine":6,"startColumn":48,"endColumn":50}},"message":{"text":".then(([basket]: [BasketModel, boolean]) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":8,"endLine":8,"startColumn":9,"endColumn":13}},"message":{"text":"user.bid = basket.id // keep track of original basket"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":10,"endLine":10,"startColumn":68,"endColumn":72}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":10,"endLine":10,"startColumn":73,"endColumn":77}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":10,"endLine":10,"startColumn":78,"endColumn":83}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":10,"endLine":10,"startColumn":66,"endColumn":67}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":10,"endLine":10,"startColumn":34,"endColumn":35}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":10,"endLine":10,"startColumn":13,"endColumn":17}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":21,"endLine":21,"startColumn":14,"endColumn":31}},"message":{"text":".then((authenticatedUser: { data: User }) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":22,"endLine":22,"startColumn":46,"endColumn":63}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":22,"endLine":22,"startColumn":28,"endColumn":45}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":22,"endLine":22,"startColumn":15,"endColumn":19}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":28,"endLine":28,"startColumn":25,"endColumn":29}},"message":{"text":"userId: user.data.id,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":28,"endLine":28,"startColumn":30,"endColumn":34}},"message":{"text":"userId: user.data.id,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":28,"endLine":28,"startColumn":35,"endColumn":37}},"message":{"text":"userId: user.data.id,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":28,"endLine":28,"startColumn":23,"endColumn":24}},"message":{"text":"userId: user.data.id,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":27,"endLine":27,"startColumn":34,"endColumn":43}},"message":{"text":"tmpToken: security.authorize({"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":27,"endLine":27,"startColumn":23,"endColumn":24}},"message":{"text":"tmpToken: security.authorize({"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":26,"endLine":26,"startColumn":17,"endColumn":18}},"message":{"text":"data: {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":24,"endLine":24,"startColumn":27,"endColumn":31}},"message":{"text":"res.status(401).json({"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":21,"endLine":21,"startColumn":14,"endColumn":31}},"message":{"text":".then((authenticatedUser: { data: User }) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":22,"endLine":22,"startColumn":46,"endColumn":63}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":22,"endLine":22,"startColumn":28,"endColumn":45}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":22,"endLine":22,"startColumn":15,"endColumn":19}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":34,"endLine":34,"startColumn":22,"endColumn":26}},"message":{"text":"afterLogin(user, res, next)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":4,"endLine":4,"startColumn":24,"endColumn":28}},"message":{"text":"function afterLogin (user: { data: User, bid: number }, res: Response, next: NextFunction) {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":6,"endLine":6,"startColumn":48,"endColumn":50}},"message":{"text":".then(([basket]: [BasketModel, boolean]) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":8,"endLine":8,"startColumn":9,"endColumn":13}},"message":{"text":"user.bid = basket.id // keep track of original basket"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":10,"endLine":10,"startColumn":68,"endColumn":72}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":10,"endLine":10,"startColumn":73,"endColumn":77}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":10,"endLine":10,"startColumn":78,"endColumn":83}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":10,"endLine":10,"startColumn":66,"endColumn":67}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":10,"endLine":10,"startColumn":34,"endColumn":35}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":9},"region":{"startLine":10,"endLine":10,"startColumn":13,"endColumn":17}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}}]}]}]},{"ruleId":"Stored_XSS","level":"error","message":{"text":"The method .then embeds untrusted data in generated output with json, at line 40 of routes\\login.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by saving malicious data in a data-store ahead of time. The attacker's modified data is then read from the database by the .then method with authenticatedUser, at line 37 of routes\\login.ts. This untrusted data then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Stored Cross-Site Scripting (XSS) attack.Similarity ID: -931879207\r\n\r\nThe method .then embeds untrusted data in generated output with json, at line 28 of routes\\login.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by saving malicious data in a data-store ahead of time. The attacker's modified data is then read from the database by the .then method with authenticatedUser, at line 37 of routes\\login.ts. This untrusted data then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Stored Cross-Site Scripting (XSS) attack.Similarity ID: 391466814"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":37,"endLine":37,"startColumn":14,"endColumn":31}},"message":{"text":".then((authenticatedUser: { data: User }) => { // vuln-code-snippet neutral-line loginAdminChallenge loginBenderChallenge loginJimChallenge"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":38,"endLine":38,"startColumn":46,"endColumn":63}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":38,"endLine":38,"startColumn":28,"endColumn":45}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":38,"endLine":38,"startColumn":15,"endColumn":19}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":44,"endLine":44,"startColumn":25,"endColumn":29}},"message":{"text":"userId: user.data.id,"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":44,"endLine":44,"startColumn":30,"endColumn":34}},"message":{"text":"userId: user.data.id,"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":44,"endLine":44,"startColumn":35,"endColumn":37}},"message":{"text":"userId: user.data.id,"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":44,"endLine":44,"startColumn":23,"endColumn":24}},"message":{"text":"userId: user.data.id,"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":43,"endLine":43,"startColumn":34,"endColumn":43}},"message":{"text":"tmpToken: security.authorize({"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":43,"endLine":43,"startColumn":23,"endColumn":24}},"message":{"text":"tmpToken: security.authorize({"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":42,"endLine":42,"startColumn":17,"endColumn":18}},"message":{"text":"data: {"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":40,"endLine":40,"startColumn":27,"endColumn":31}},"message":{"text":"res.status(401).json({"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":37,"endLine":37,"startColumn":14,"endColumn":31}},"message":{"text":".then((authenticatedUser: { data: User }) => { // vuln-code-snippet neutral-line loginAdminChallenge loginBenderChallenge loginJimChallenge"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":38,"endLine":38,"startColumn":46,"endColumn":63}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":38,"endLine":38,"startColumn":28,"endColumn":45}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":38,"endLine":38,"startColumn":15,"endColumn":19}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":50,"endLine":50,"startColumn":22,"endColumn":26}},"message":{"text":"afterLogin(user, res, next)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":21,"endLine":21,"startColumn":24,"endColumn":28}},"message":{"text":"function afterLogin (user: { data: User, bid: number }, res: Response, next: NextFunction) {"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":24,"endLine":24,"startColumn":48,"endColumn":50}},"message":{"text":".then(([basket]: [BasketModel, boolean]) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":26,"endLine":26,"startColumn":9,"endColumn":13}},"message":{"text":"user.bid = basket.id // keep track of original basket"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":28,"endLine":28,"startColumn":68,"endColumn":72}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":28,"endLine":28,"startColumn":73,"endColumn":77}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":28,"endLine":28,"startColumn":78,"endColumn":83}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":28,"endLine":28,"startColumn":66,"endColumn":67}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":28,"endLine":28,"startColumn":34,"endColumn":35}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":28,"endLine":28,"startColumn":13,"endColumn":17}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":37,"endLine":37,"startColumn":14,"endColumn":31}},"message":{"text":".then((authenticatedUser: { data: User }) => { // vuln-code-snippet neutral-line loginAdminChallenge loginBenderChallenge loginJimChallenge"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":38,"endLine":38,"startColumn":46,"endColumn":63}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":38,"endLine":38,"startColumn":28,"endColumn":45}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":38,"endLine":38,"startColumn":15,"endColumn":19}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":44,"endLine":44,"startColumn":25,"endColumn":29}},"message":{"text":"userId: user.data.id,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":44,"endLine":44,"startColumn":30,"endColumn":34}},"message":{"text":"userId: user.data.id,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":44,"endLine":44,"startColumn":35,"endColumn":37}},"message":{"text":"userId: user.data.id,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":44,"endLine":44,"startColumn":23,"endColumn":24}},"message":{"text":"userId: user.data.id,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":43,"endLine":43,"startColumn":34,"endColumn":43}},"message":{"text":"tmpToken: security.authorize({"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":43,"endLine":43,"startColumn":23,"endColumn":24}},"message":{"text":"tmpToken: security.authorize({"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":42,"endLine":42,"startColumn":17,"endColumn":18}},"message":{"text":"data: {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":40,"endLine":40,"startColumn":27,"endColumn":31}},"message":{"text":"res.status(401).json({"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":37,"endLine":37,"startColumn":14,"endColumn":31}},"message":{"text":".then((authenticatedUser: { data: User }) => { // vuln-code-snippet neutral-line loginAdminChallenge loginBenderChallenge loginJimChallenge"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":38,"endLine":38,"startColumn":46,"endColumn":63}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":38,"endLine":38,"startColumn":28,"endColumn":45}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":38,"endLine":38,"startColumn":15,"endColumn":19}},"message":{"text":"const user = utils.queryResultToJson(authenticatedUser)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":50,"endLine":50,"startColumn":22,"endColumn":26}},"message":{"text":"afterLogin(user, res, next)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":21,"endLine":21,"startColumn":24,"endColumn":28}},"message":{"text":"function afterLogin (user: { data: User, bid: number }, res: Response, next: NextFunction) {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":24,"endLine":24,"startColumn":48,"endColumn":50}},"message":{"text":".then(([basket]: [BasketModel, boolean]) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":26,"endLine":26,"startColumn":9,"endColumn":13}},"message":{"text":"user.bid = basket.id // keep track of original basket"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":28,"endLine":28,"startColumn":68,"endColumn":72}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":28,"endLine":28,"startColumn":73,"endColumn":77}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":28,"endLine":28,"startColumn":78,"endColumn":83}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":28,"endLine":28,"startColumn":66,"endColumn":67}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":28,"endLine":28,"startColumn":34,"endColumn":35}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":10},"region":{"startLine":28,"endLine":28,"startColumn":13,"endColumn":17}},"message":{"text":"res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"}}}]}]}]},{"ruleId":"Stored_XSS","level":"error","message":{"text":"The method exports.checkVulnLines embeds untrusted data in generated output with json, at line 115 of routes\\vulnCodeSnippet.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by saving malicious data in a data-store ahead of time. The attacker's modified data is then read from the database by the exports.checkVulnLines method with readFileSync, at line 94 of routes\\vulnCodeSnippet.ts. This untrusted data then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Stored Cross-Site Scripting (XSS) attack.Similarity ID: -618497098"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":94,"endLine":94,"startColumn":47,"endColumn":59}},"message":{"text":"const codingChallengeInfos = yaml.load(fs.readFileSync('./data/static/codefixes/' + key + '.info.yml', 'utf8'))"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":94,"endLine":94,"startColumn":39,"endColumn":43}},"message":{"text":"const codingChallengeInfos = yaml.load(fs.readFileSync('./data/static/codefixes/' + key + '.info.yml', 'utf8'))"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":94,"endLine":94,"startColumn":11,"endColumn":31}},"message":{"text":"const codingChallengeInfos = yaml.load(fs.readFileSync('./data/static/codefixes/' + key + '.info.yml', 'utf8'))"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":103,"endLine":103,"startColumn":26,"endColumn":46}},"message":{"text":"const nextHint = codingChallengeInfos.hints[accuracy.getFindItAttempts(key) - 1] // -1 prevents after first attempt"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":103,"endLine":103,"startColumn":47,"endColumn":52}},"message":{"text":"const nextHint = codingChallengeInfos.hints[accuracy.getFindItAttempts(key) - 1] // -1 prevents after first attempt"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":103,"endLine":103,"startColumn":15,"endColumn":23}},"message":{"text":"const nextHint = codingChallengeInfos.hints[accuracy.getFindItAttempts(key) - 1] // -1 prevents after first attempt"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":104,"endLine":104,"startColumn":37,"endColumn":45}},"message":{"text":"if (nextHint) hint = res.__(nextHint)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":104,"endLine":104,"startColumn":34,"endColumn":36}},"message":{"text":"if (nextHint) hint = res.__(nextHint)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":104,"endLine":104,"startColumn":23,"endColumn":27}},"message":{"text":"if (nextHint) hint = res.__(nextHint)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":117,"endLine":117,"startColumn":7,"endColumn":11}},"message":{"text":"hint"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":117,"endLine":117,"startColumn":7,"endColumn":11}},"message":{"text":"hint"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":115,"endLine":115,"startColumn":21,"endColumn":25}},"message":{"text":"res.status(200).json({"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":94,"endLine":94,"startColumn":47,"endColumn":59}},"message":{"text":"const codingChallengeInfos = yaml.load(fs.readFileSync('./data/static/codefixes/' + key + '.info.yml', 'utf8'))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":94,"endLine":94,"startColumn":39,"endColumn":43}},"message":{"text":"const codingChallengeInfos = yaml.load(fs.readFileSync('./data/static/codefixes/' + key + '.info.yml', 'utf8'))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":94,"endLine":94,"startColumn":11,"endColumn":31}},"message":{"text":"const codingChallengeInfos = yaml.load(fs.readFileSync('./data/static/codefixes/' + key + '.info.yml', 'utf8'))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":103,"endLine":103,"startColumn":26,"endColumn":46}},"message":{"text":"const nextHint = codingChallengeInfos.hints[accuracy.getFindItAttempts(key) - 1] // -1 prevents after first attempt"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":103,"endLine":103,"startColumn":47,"endColumn":52}},"message":{"text":"const nextHint = codingChallengeInfos.hints[accuracy.getFindItAttempts(key) - 1] // -1 prevents after first attempt"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":103,"endLine":103,"startColumn":15,"endColumn":23}},"message":{"text":"const nextHint = codingChallengeInfos.hints[accuracy.getFindItAttempts(key) - 1] // -1 prevents after first attempt"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":104,"endLine":104,"startColumn":37,"endColumn":45}},"message":{"text":"if (nextHint) hint = res.__(nextHint)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":104,"endLine":104,"startColumn":34,"endColumn":36}},"message":{"text":"if (nextHint) hint = res.__(nextHint)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":104,"endLine":104,"startColumn":23,"endColumn":27}},"message":{"text":"if (nextHint) hint = res.__(nextHint)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":117,"endLine":117,"startColumn":7,"endColumn":11}},"message":{"text":"hint"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":117,"endLine":117,"startColumn":7,"endColumn":11}},"message":{"text":"hint"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeSnippet.ts","uriBaseId":"%SRCROOT%","index":11},"region":{"startLine":115,"endLine":115,"startColumn":21,"endColumn":25}},"message":{"text":"res.status(200).json({"}}}]}]}]},{"ruleId":"Stored_XSS","level":"error","message":{"text":"The method checkCorrectFix embeds untrusted data in generated output with json, at line 88 of routes\\vulnCodeFixes.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by saving malicious data in a data-store ahead of time. The attacker's modified data is then read from the database by the checkCorrectFix method with readFileSync, at line 82 of routes\\vulnCodeFixes.ts. This untrusted data then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Stored Cross-Site Scripting (XSS) attack.Similarity ID: -708708062\r\n\r\nThe method checkCorrectFix embeds untrusted data in generated output with json, at line 94 of routes\\vulnCodeFixes.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by saving malicious data in a data-store ahead of time. The attacker's modified data is then read from the database by the checkCorrectFix method with readFileSync, at line 82 of routes\\vulnCodeFixes.ts. This untrusted data then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Stored Cross-Site Scripting (XSS) attack.Similarity ID: -708708062\r\n\r\nThe method serveCodeFixes embeds untrusted data in generated output with json, at line 66 of routes\\vulnCodeFixes.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by saving malicious data in a data-store ahead of time. The attacker's modified data is then read from the database by the readFixes method with readFileSync, at line 30 of routes\\vulnCodeFixes.ts. This untrusted data then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Stored Cross-Site Scripting (XSS) attack.Similarity ID: 957124287"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":82,"endLine":82,"startColumn":49,"endColumn":61}},"message":{"text":"const codingChallengeInfos = yaml.load(fs.readFileSync('./data/static/codefixes/' + key + '.info.yml', 'utf8'))"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":82,"endLine":82,"startColumn":41,"endColumn":45}},"message":{"text":"const codingChallengeInfos = yaml.load(fs.readFileSync('./data/static/codefixes/' + key + '.info.yml', 'utf8'))"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":82,"endLine":82,"startColumn":13,"endColumn":33}},"message":{"text":"const codingChallengeInfos = yaml.load(fs.readFileSync('./data/static/codefixes/' + key + '.info.yml', 'utf8'))"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":83,"endLine":83,"startColumn":31,"endColumn":51}},"message":{"text":"const selectedFixInfo = codingChallengeInfos?.fixes.find(({ id }: { id: number }) => id === selectedFix + 1)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":83,"endLine":83,"startColumn":53,"endColumn":58}},"message":{"text":"const selectedFixInfo = codingChallengeInfos?.fixes.find(({ id }: { id: number }) => id === selectedFix + 1)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":83,"endLine":83,"startColumn":59,"endColumn":63}},"message":{"text":"const selectedFixInfo = codingChallengeInfos?.fixes.find(({ id }: { id: number }) => id === selectedFix + 1)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":83,"endLine":83,"startColumn":13,"endColumn":28}},"message":{"text":"const selectedFixInfo = codingChallengeInfos?.fixes.find(({ id }: { id: number }) => id === selectedFix + 1)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":84,"endLine":84,"startColumn":62,"endColumn":77}},"message":{"text":"if (selectedFixInfo?.explanation) explanation = res.__(selectedFixInfo.explanation)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":84,"endLine":84,"startColumn":78,"endColumn":89}},"message":{"text":"if (selectedFixInfo?.explanation) explanation = res.__(selectedFixInfo.explanation)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":84,"endLine":84,"startColumn":59,"endColumn":61}},"message":{"text":"if (selectedFixInfo?.explanation) explanation = res.__(selectedFixInfo.explanation)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":84,"endLine":84,"startColumn":41,"endColumn":52}},"message":{"text":"if (selectedFixInfo?.explanation) explanation = res.__(selectedFixInfo.explanation)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":90,"endLine":90,"startColumn":9,"endColumn":20}},"message":{"text":"explanation"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":90,"endLine":90,"startColumn":9,"endColumn":20}},"message":{"text":"explanation"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":88,"endLine":88,"startColumn":23,"endColumn":27}},"message":{"text":"res.status(200).json({"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":82,"endLine":82,"startColumn":49,"endColumn":61}},"message":{"text":"const codingChallengeInfos = yaml.load(fs.readFileSync('./data/static/codefixes/' + key + '.info.yml', 'utf8'))"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":82,"endLine":82,"startColumn":41,"endColumn":45}},"message":{"text":"const codingChallengeInfos = yaml.load(fs.readFileSync('./data/static/codefixes/' + key + '.info.yml', 'utf8'))"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":82,"endLine":82,"startColumn":13,"endColumn":33}},"message":{"text":"const codingChallengeInfos = yaml.load(fs.readFileSync('./data/static/codefixes/' + key + '.info.yml', 'utf8'))"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":83,"endLine":83,"startColumn":31,"endColumn":51}},"message":{"text":"const selectedFixInfo = codingChallengeInfos?.fixes.find(({ id }: { id: number }) => id === selectedFix + 1)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":83,"endLine":83,"startColumn":53,"endColumn":58}},"message":{"text":"const selectedFixInfo = codingChallengeInfos?.fixes.find(({ id }: { id: number }) => id === selectedFix + 1)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":83,"endLine":83,"startColumn":59,"endColumn":63}},"message":{"text":"const selectedFixInfo = codingChallengeInfos?.fixes.find(({ id }: { id: number }) => id === selectedFix + 1)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":83,"endLine":83,"startColumn":13,"endColumn":28}},"message":{"text":"const selectedFixInfo = codingChallengeInfos?.fixes.find(({ id }: { id: number }) => id === selectedFix + 1)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":84,"endLine":84,"startColumn":62,"endColumn":77}},"message":{"text":"if (selectedFixInfo?.explanation) explanation = res.__(selectedFixInfo.explanation)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":84,"endLine":84,"startColumn":78,"endColumn":89}},"message":{"text":"if (selectedFixInfo?.explanation) explanation = res.__(selectedFixInfo.explanation)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":84,"endLine":84,"startColumn":59,"endColumn":61}},"message":{"text":"if (selectedFixInfo?.explanation) explanation = res.__(selectedFixInfo.explanation)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":84,"endLine":84,"startColumn":41,"endColumn":52}},"message":{"text":"if (selectedFixInfo?.explanation) explanation = res.__(selectedFixInfo.explanation)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":96,"endLine":96,"startColumn":9,"endColumn":20}},"message":{"text":"explanation"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":96,"endLine":96,"startColumn":9,"endColumn":20}},"message":{"text":"explanation"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":94,"endLine":94,"startColumn":23,"endColumn":27}},"message":{"text":"res.status(200).json({"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":30,"endLine":30,"startColumn":22,"endColumn":34}},"message":{"text":"const fix = fs.readFileSync(`${FixesDir}/${file}`).toString()"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":30,"endLine":30,"startColumn":58,"endColumn":66}},"message":{"text":"const fix = fs.readFileSync(`${FixesDir}/${file}`).toString()"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":30,"endLine":30,"startColumn":13,"endColumn":16}},"message":{"text":"const fix = fs.readFileSync(`${FixesDir}/${file}`).toString()"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":33,"endLine":33,"startColumn":18,"endColumn":21}},"message":{"text":"fixes.push(fix)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":33,"endLine":33,"startColumn":13,"endColumn":17}},"message":{"text":"fixes.push(fix)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":33,"endLine":33,"startColumn":7,"endColumn":12}},"message":{"text":"fixes.push(fix)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":42,"endLine":42,"startColumn":12,"endColumn":17}},"message":{"text":"fixes: fixes,"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":42,"endLine":42,"startColumn":10,"endColumn":11}},"message":{"text":"fixes: fixes,"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":41,"endLine":41,"startColumn":3,"endColumn":12}},"message":{"text":"CodeFixes[key] = {"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":45,"endLine":45,"startColumn":10,"endColumn":19}},"message":{"text":"return CodeFixes[key]"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":59,"endLine":59,"startColumn":19,"endColumn":28}},"message":{"text":"const fixData = readFixes(key)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":59,"endLine":59,"startColumn":9,"endColumn":16}},"message":{"text":"const fixData = readFixes(key)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":67,"endLine":67,"startColumn":12,"endColumn":19}},"message":{"text":"fixes: fixData.fixes"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":67,"endLine":67,"startColumn":20,"endColumn":25}},"message":{"text":"fixes: fixData.fixes"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":67,"endLine":67,"startColumn":10,"endColumn":11}},"message":{"text":"fixes: fixData.fixes"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":66,"endLine":66,"startColumn":19,"endColumn":23}},"message":{"text":"res.status(200).json({"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":82,"endLine":82,"startColumn":49,"endColumn":61}},"message":{"text":"const codingChallengeInfos = yaml.load(fs.readFileSync('./data/static/codefixes/' + key + '.info.yml', 'utf8'))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":82,"endLine":82,"startColumn":41,"endColumn":45}},"message":{"text":"const codingChallengeInfos = yaml.load(fs.readFileSync('./data/static/codefixes/' + key + '.info.yml', 'utf8'))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":82,"endLine":82,"startColumn":13,"endColumn":33}},"message":{"text":"const codingChallengeInfos = yaml.load(fs.readFileSync('./data/static/codefixes/' + key + '.info.yml', 'utf8'))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":83,"endLine":83,"startColumn":31,"endColumn":51}},"message":{"text":"const selectedFixInfo = codingChallengeInfos?.fixes.find(({ id }: { id: number }) => id === selectedFix + 1)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":83,"endLine":83,"startColumn":53,"endColumn":58}},"message":{"text":"const selectedFixInfo = codingChallengeInfos?.fixes.find(({ id }: { id: number }) => id === selectedFix + 1)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":83,"endLine":83,"startColumn":59,"endColumn":63}},"message":{"text":"const selectedFixInfo = codingChallengeInfos?.fixes.find(({ id }: { id: number }) => id === selectedFix + 1)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":83,"endLine":83,"startColumn":13,"endColumn":28}},"message":{"text":"const selectedFixInfo = codingChallengeInfos?.fixes.find(({ id }: { id: number }) => id === selectedFix + 1)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":84,"endLine":84,"startColumn":62,"endColumn":77}},"message":{"text":"if (selectedFixInfo?.explanation) explanation = res.__(selectedFixInfo.explanation)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":84,"endLine":84,"startColumn":78,"endColumn":89}},"message":{"text":"if (selectedFixInfo?.explanation) explanation = res.__(selectedFixInfo.explanation)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":84,"endLine":84,"startColumn":59,"endColumn":61}},"message":{"text":"if (selectedFixInfo?.explanation) explanation = res.__(selectedFixInfo.explanation)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":84,"endLine":84,"startColumn":41,"endColumn":52}},"message":{"text":"if (selectedFixInfo?.explanation) explanation = res.__(selectedFixInfo.explanation)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":90,"endLine":90,"startColumn":9,"endColumn":20}},"message":{"text":"explanation"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":90,"endLine":90,"startColumn":9,"endColumn":20}},"message":{"text":"explanation"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":88,"endLine":88,"startColumn":23,"endColumn":27}},"message":{"text":"res.status(200).json({"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":82,"endLine":82,"startColumn":49,"endColumn":61}},"message":{"text":"const codingChallengeInfos = yaml.load(fs.readFileSync('./data/static/codefixes/' + key + '.info.yml', 'utf8'))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":82,"endLine":82,"startColumn":41,"endColumn":45}},"message":{"text":"const codingChallengeInfos = yaml.load(fs.readFileSync('./data/static/codefixes/' + key + '.info.yml', 'utf8'))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":82,"endLine":82,"startColumn":13,"endColumn":33}},"message":{"text":"const codingChallengeInfos = yaml.load(fs.readFileSync('./data/static/codefixes/' + key + '.info.yml', 'utf8'))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":83,"endLine":83,"startColumn":31,"endColumn":51}},"message":{"text":"const selectedFixInfo = codingChallengeInfos?.fixes.find(({ id }: { id: number }) => id === selectedFix + 1)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":83,"endLine":83,"startColumn":53,"endColumn":58}},"message":{"text":"const selectedFixInfo = codingChallengeInfos?.fixes.find(({ id }: { id: number }) => id === selectedFix + 1)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":83,"endLine":83,"startColumn":59,"endColumn":63}},"message":{"text":"const selectedFixInfo = codingChallengeInfos?.fixes.find(({ id }: { id: number }) => id === selectedFix + 1)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":83,"endLine":83,"startColumn":13,"endColumn":28}},"message":{"text":"const selectedFixInfo = codingChallengeInfos?.fixes.find(({ id }: { id: number }) => id === selectedFix + 1)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":84,"endLine":84,"startColumn":62,"endColumn":77}},"message":{"text":"if (selectedFixInfo?.explanation) explanation = res.__(selectedFixInfo.explanation)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":84,"endLine":84,"startColumn":78,"endColumn":89}},"message":{"text":"if (selectedFixInfo?.explanation) explanation = res.__(selectedFixInfo.explanation)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":84,"endLine":84,"startColumn":59,"endColumn":61}},"message":{"text":"if (selectedFixInfo?.explanation) explanation = res.__(selectedFixInfo.explanation)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":84,"endLine":84,"startColumn":41,"endColumn":52}},"message":{"text":"if (selectedFixInfo?.explanation) explanation = res.__(selectedFixInfo.explanation)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":96,"endLine":96,"startColumn":9,"endColumn":20}},"message":{"text":"explanation"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":96,"endLine":96,"startColumn":9,"endColumn":20}},"message":{"text":"explanation"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":94,"endLine":94,"startColumn":23,"endColumn":27}},"message":{"text":"res.status(200).json({"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":30,"endLine":30,"startColumn":22,"endColumn":34}},"message":{"text":"const fix = fs.readFileSync(`${FixesDir}/${file}`).toString()"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":30,"endLine":30,"startColumn":58,"endColumn":66}},"message":{"text":"const fix = fs.readFileSync(`${FixesDir}/${file}`).toString()"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":30,"endLine":30,"startColumn":13,"endColumn":16}},"message":{"text":"const fix = fs.readFileSync(`${FixesDir}/${file}`).toString()"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":33,"endLine":33,"startColumn":18,"endColumn":21}},"message":{"text":"fixes.push(fix)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":33,"endLine":33,"startColumn":13,"endColumn":17}},"message":{"text":"fixes.push(fix)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":33,"endLine":33,"startColumn":7,"endColumn":12}},"message":{"text":"fixes.push(fix)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":42,"endLine":42,"startColumn":12,"endColumn":17}},"message":{"text":"fixes: fixes,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":42,"endLine":42,"startColumn":10,"endColumn":11}},"message":{"text":"fixes: fixes,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":41,"endLine":41,"startColumn":3,"endColumn":12}},"message":{"text":"CodeFixes[key] = {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":45,"endLine":45,"startColumn":10,"endColumn":19}},"message":{"text":"return CodeFixes[key]"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":59,"endLine":59,"startColumn":19,"endColumn":28}},"message":{"text":"const fixData = readFixes(key)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":59,"endLine":59,"startColumn":9,"endColumn":16}},"message":{"text":"const fixData = readFixes(key)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":67,"endLine":67,"startColumn":12,"endColumn":19}},"message":{"text":"fixes: fixData.fixes"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":67,"endLine":67,"startColumn":20,"endColumn":25}},"message":{"text":"fixes: fixData.fixes"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":67,"endLine":67,"startColumn":10,"endColumn":11}},"message":{"text":"fixes: fixData.fixes"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/vulnCodeFixes.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":66,"endLine":66,"startColumn":19,"endColumn":23}},"message":{"text":"res.status(200).json({"}}}]}]}]},{"ruleId":"SQL_Injection","level":"error","message":{"text":"The application's return method executes an SQL query with query, at line 20 of data\\static\\codefixes\\loginAdminChallenge_1.ts. The application constructs this SQL query by embedding an untrusted string into the query without proper sanitization. The concatenated string is submitted to the database, where it is parsed and executed accordingly.An attacker would be able to inject arbitrary syntax and data into the SQL query, by crafting a malicious payload and providing it via the input email; this input is then read by the return method at line 20 of data\\static\\codefixes\\loginAdminChallenge_1.ts. This input then flows through the code, into a query and to the database server - without sanitization.This may enable an SQL Injection attack.Similarity ID: -1707266195\r\n\r\nThe application's return method executes an SQL query with query, at line 20 of data\\static\\codefixes\\loginAdminChallenge_1.ts. The application constructs this SQL query by embedding an untrusted string into the query without proper sanitization. The concatenated string is submitted to the database, where it is parsed and executed accordingly.An attacker would be able to inject arbitrary syntax and data into the SQL query, by crafting a malicious payload and providing it via the input password; this input is then read by the return method at line 20 of data\\static\\codefixes\\loginAdminChallenge_1.ts. This input then flows through the code, into a query and to the database server - without sanitization.This may enable an SQL Injection attack.Similarity ID: -1843283289"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":75,"endColumn":80}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":130,"endColumn":138}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":116,"endColumn":120}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":75,"endColumn":80}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":130,"endColumn":138}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":116,"endColumn":120}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}}}]}]}]},{"ruleId":"SQL_Injection","level":"error","message":{"text":"The application's return method executes an SQL query with query, at line 20 of data\\static\\codefixes\\loginBenderChallenge_1.ts. The application constructs this SQL query by embedding an untrusted string into the query without proper sanitization. The concatenated string is submitted to the database, where it is parsed and executed accordingly.An attacker would be able to inject arbitrary syntax and data into the SQL query, by crafting a malicious payload and providing it via the input email; this input is then read by the return method at line 20 of data\\static\\codefixes\\loginBenderChallenge_1.ts. This input then flows through the code, into a query and to the database server - without sanitization.This may enable an SQL Injection attack.Similarity ID: 1988286367\r\n\r\nThe application's return method executes an SQL query with query, at line 20 of data\\static\\codefixes\\loginBenderChallenge_1.ts. The application constructs this SQL query by embedding an untrusted string into the query without proper sanitization. The concatenated string is submitted to the database, where it is parsed and executed accordingly.An attacker would be able to inject arbitrary syntax and data into the SQL query, by crafting a malicious payload and providing it via the input password; this input is then read by the return method at line 20 of data\\static\\codefixes\\loginBenderChallenge_1.ts. This input then flows through the code, into a query and to the database server - without sanitization.This may enable an SQL Injection attack.Similarity ID: 2066723749"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":75,"endColumn":80}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":130,"endColumn":138}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":116,"endColumn":120}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":75,"endColumn":80}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":130,"endColumn":138}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":116,"endColumn":120}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}}}]}]}]},{"ruleId":"SQL_Injection","level":"error","message":{"text":"The application's return method executes an SQL query with query, at line 20 of data\\static\\codefixes\\loginJimChallenge_4.ts. The application constructs this SQL query by embedding an untrusted string into the query without proper sanitization. The concatenated string is submitted to the database, where it is parsed and executed accordingly.An attacker would be able to inject arbitrary syntax and data into the SQL query, by crafting a malicious payload and providing it via the input email; this input is then read by the return method at line 20 of data\\static\\codefixes\\loginJimChallenge_4.ts. This input then flows through the code, into a query and to the database server - without sanitization.This may enable an SQL Injection attack.Similarity ID: -1023794315\r\n\r\nThe application's return method executes an SQL query with query, at line 20 of data\\static\\codefixes\\loginJimChallenge_4.ts. The application constructs this SQL query by embedding an untrusted string into the query without proper sanitization. The concatenated string is submitted to the database, where it is parsed and executed accordingly.An attacker would be able to inject arbitrary syntax and data into the SQL query, by crafting a malicious payload and providing it via the input password; this input is then read by the return method at line 20 of data\\static\\codefixes\\loginJimChallenge_4.ts. This input then flows through the code, into a query and to the database server - without sanitization.This may enable an SQL Injection attack.Similarity ID: 991704367"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":75,"endColumn":80}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":130,"endColumn":138}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":116,"endColumn":120}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":75,"endColumn":80}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":130,"endColumn":138}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":116,"endColumn":120}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/loginJimChallenge_4.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":20,"endLine":20,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: models.User, plain: true })"}}}]}]}]},{"ruleId":"SQL_Injection","level":"error","message":{"text":"The application's return method executes an SQL query with query, at line 36 of routes\\login.ts. The application constructs this SQL query by embedding an untrusted string into the query without proper sanitization. The concatenated string is submitted to the database, where it is parsed and executed accordingly.An attacker would be able to inject arbitrary syntax and data into the SQL query, by crafting a malicious payload and providing it via the input email; this input is then read by the return method at line 36 of routes\\login.ts. This input then flows through the code, into a query and to the database server - without sanitization.This may enable an SQL Injection attack.Similarity ID: -1085522593\r\n\r\nThe application's return method executes an SQL query with query, at line 36 of routes\\login.ts. The application constructs this SQL query by embedding an untrusted string into the query without proper sanitization. The concatenated string is submitted to the database, where it is parsed and executed accordingly.An attacker would be able to inject arbitrary syntax and data into the SQL query, by crafting a malicious payload and providing it via the input password; this input is then read by the return method at line 36 of routes\\login.ts. This input then flows through the code, into a query and to the database server - without sanitization.This may enable an SQL Injection attack.Similarity ID: 38805145"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":36,"endLine":36,"startColumn":75,"endColumn":80}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: UserModel, plain: true }) // vuln-code-snippet vuln-line loginAdminChallenge loginBenderChallenge loginJimChallenge"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":36,"endLine":36,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: UserModel, plain: true }) // vuln-code-snippet vuln-line loginAdminChallenge loginBenderChallenge loginJimChallenge"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":36,"endLine":36,"startColumn":130,"endColumn":138}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: UserModel, plain: true }) // vuln-code-snippet vuln-line loginAdminChallenge loginBenderChallenge loginJimChallenge"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":36,"endLine":36,"startColumn":116,"endColumn":120}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: UserModel, plain: true }) // vuln-code-snippet vuln-line loginAdminChallenge loginBenderChallenge loginJimChallenge"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":36,"endLine":36,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: UserModel, plain: true }) // vuln-code-snippet vuln-line loginAdminChallenge loginBenderChallenge loginJimChallenge"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":36,"endLine":36,"startColumn":75,"endColumn":80}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: UserModel, plain: true }) // vuln-code-snippet vuln-line loginAdminChallenge loginBenderChallenge loginJimChallenge"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":36,"endLine":36,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: UserModel, plain: true }) // vuln-code-snippet vuln-line loginAdminChallenge loginBenderChallenge loginJimChallenge"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":36,"endLine":36,"startColumn":130,"endColumn":138}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: UserModel, plain: true }) // vuln-code-snippet vuln-line loginAdminChallenge loginBenderChallenge loginJimChallenge"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":36,"endLine":36,"startColumn":116,"endColumn":120}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: UserModel, plain: true }) // vuln-code-snippet vuln-line loginAdminChallenge loginBenderChallenge loginJimChallenge"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/login.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":36,"endLine":36,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: UserModel, plain: true }) // vuln-code-snippet vuln-line loginAdminChallenge loginBenderChallenge loginJimChallenge"}}}]}]}]},{"ruleId":"SQL_Injection","level":"error","message":{"text":"The application's return method executes an SQL query with query, at line 5 of data\\static\\codefixes\\dbSchemaChallenge_1.ts. The application constructs this SQL query by embedding an untrusted string into the query without proper sanitization. The concatenated string is submitted to the database, where it is parsed and executed accordingly.An attacker would be able to inject arbitrary syntax and data into the SQL query, by crafting a malicious payload and providing it via the input q; this input is then read by the return method at line 3 of data\\static\\codefixes\\dbSchemaChallenge_1.ts. This input then flows through the code, into a query and to the database server - without sanitization.This may enable an SQL Injection attack.Similarity ID: 1520572051"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":3,"endLine":3,"startColumn":70,"endColumn":71}},"message":{"text":"let criteria: any = req.query.q === 'undefined' ? '' : req.query.q ?? ''"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":3,"endLine":3,"startColumn":9,"endColumn":17}},"message":{"text":"let criteria: any = req.query.q === 'undefined' ? '' : req.query.q ?? ''"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":4,"endLine":4,"startColumn":43,"endColumn":51}},"message":{"text":"criteria = (criteria.length <= 200) ? criteria : criteria.substring(0, 200)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":4,"endLine":4,"startColumn":5,"endColumn":13}},"message":{"text":"criteria = (criteria.length <= 200) ? criteria : criteria.substring(0, 200)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":5,"endLine":5,"startColumn":111,"endColumn":119}},"message":{"text":"models.sequelize.query(\"SELECT * FROM Products WHERE ((name LIKE '%\"+criteria+\"%' OR description LIKE '%\"+criteria+\"%') AND deletedAt IS NULL) ORDER BY name\")"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":5,"endLine":5,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(\"SELECT * FROM Products WHERE ((name LIKE '%\"+criteria+\"%' OR description LIKE '%\"+criteria+\"%') AND deletedAt IS NULL) ORDER BY name\")"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":3,"endLine":3,"startColumn":70,"endColumn":71}},"message":{"text":"let criteria: any = req.query.q === 'undefined' ? '' : req.query.q ?? ''"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":3,"endLine":3,"startColumn":9,"endColumn":17}},"message":{"text":"let criteria: any = req.query.q === 'undefined' ? '' : req.query.q ?? ''"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":4,"endLine":4,"startColumn":43,"endColumn":51}},"message":{"text":"criteria = (criteria.length <= 200) ? criteria : criteria.substring(0, 200)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":4,"endLine":4,"startColumn":5,"endColumn":13}},"message":{"text":"criteria = (criteria.length <= 200) ? criteria : criteria.substring(0, 200)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":5,"endLine":5,"startColumn":111,"endColumn":119}},"message":{"text":"models.sequelize.query(\"SELECT * FROM Products WHERE ((name LIKE '%\"+criteria+\"%' OR description LIKE '%\"+criteria+\"%') AND deletedAt IS NULL) ORDER BY name\")"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":5,"endLine":5,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(\"SELECT * FROM Products WHERE ((name LIKE '%\"+criteria+\"%' OR description LIKE '%\"+criteria+\"%') AND deletedAt IS NULL) ORDER BY name\")"}}}]}]}]},{"ruleId":"SQL_Injection","level":"error","message":{"text":"The application's return method executes an SQL query with query, at line 23 of routes\\search.ts. The application constructs this SQL query by embedding an untrusted string into the query without proper sanitization. The concatenated string is submitted to the database, where it is parsed and executed accordingly.An attacker would be able to inject arbitrary syntax and data into the SQL query, by crafting a malicious payload and providing it via the input q; this input is then read by the return method at line 21 of routes\\search.ts. This input then flows through the code, into a query and to the database server - without sanitization.This may enable an SQL Injection attack.Similarity ID: 1769161795"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":21,"endLine":21,"startColumn":70,"endColumn":71}},"message":{"text":"let criteria: any = req.query.q === 'undefined' ? '' : req.query.q ?? ''"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":21,"endLine":21,"startColumn":9,"endColumn":17}},"message":{"text":"let criteria: any = req.query.q === 'undefined' ? '' : req.query.q ?? ''"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":22,"endLine":22,"startColumn":43,"endColumn":51}},"message":{"text":"criteria = (criteria.length <= 200) ? criteria : criteria.substring(0, 200)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":22,"endLine":22,"startColumn":5,"endColumn":13}},"message":{"text":"criteria = (criteria.length <= 200) ? criteria : criteria.substring(0, 200)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":23,"endLine":23,"startColumn":110,"endColumn":118}},"message":{"text":"models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`) // vuln-code-snippet vuln-line unionSqlInjectionChallenge dbSchemaChallenge"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":23,"endLine":23,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`) // vuln-code-snippet vuln-line unionSqlInjectionChallenge dbSchemaChallenge"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":21,"endLine":21,"startColumn":70,"endColumn":71}},"message":{"text":"let criteria: any = req.query.q === 'undefined' ? '' : req.query.q ?? ''"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":21,"endLine":21,"startColumn":9,"endColumn":17}},"message":{"text":"let criteria: any = req.query.q === 'undefined' ? '' : req.query.q ?? ''"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":22,"endLine":22,"startColumn":43,"endColumn":51}},"message":{"text":"criteria = (criteria.length <= 200) ? criteria : criteria.substring(0, 200)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":22,"endLine":22,"startColumn":5,"endColumn":13}},"message":{"text":"criteria = (criteria.length <= 200) ? criteria : criteria.substring(0, 200)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":23,"endLine":23,"startColumn":110,"endColumn":118}},"message":{"text":"models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`) // vuln-code-snippet vuln-line unionSqlInjectionChallenge dbSchemaChallenge"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/search.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":23,"endLine":23,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`) // vuln-code-snippet vuln-line unionSqlInjectionChallenge dbSchemaChallenge"}}}]}]}]},{"ruleId":"SQL_Injection","level":"error","message":{"text":"The application's return method executes an SQL query with query, at line 6 of data\\static\\codefixes\\unionSqlInjectionChallenge_1.ts. The application constructs this SQL query by embedding an untrusted string into the query without proper sanitization. The concatenated string is submitted to the database, where it is parsed and executed accordingly.An attacker would be able to inject arbitrary syntax and data into the SQL query, by crafting a malicious payload and providing it via the input q; this input is then read by the return method at line 3 of data\\static\\codefixes\\unionSqlInjectionChallenge_1.ts. This input then flows through the code, into a query and to the database server - without sanitization.This may enable an SQL Injection attack.Similarity ID: 1524855538"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":3,"endLine":3,"startColumn":70,"endColumn":71}},"message":{"text":"let criteria: any = req.query.q === 'undefined' ? '' : req.query.q ?? ''"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":3,"endLine":3,"startColumn":9,"endColumn":17}},"message":{"text":"let criteria: any = req.query.q === 'undefined' ? '' : req.query.q ?? ''"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":4,"endLine":4,"startColumn":43,"endColumn":51}},"message":{"text":"criteria = (criteria.length <= 200) ? criteria : criteria.substring(0, 200)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":4,"endLine":4,"startColumn":5,"endColumn":13}},"message":{"text":"criteria = (criteria.length <= 200) ? criteria : criteria.substring(0, 200)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":5,"endLine":5,"startColumn":5,"endColumn":13}},"message":{"text":"criteria.replace(/\"|'|;|and|or/i, \"\")"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":6,"endLine":6,"startColumn":110,"endColumn":118}},"message":{"text":"models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":6,"endLine":6,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":3,"endLine":3,"startColumn":70,"endColumn":71}},"message":{"text":"let criteria: any = req.query.q === 'undefined' ? '' : req.query.q ?? ''"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":3,"endLine":3,"startColumn":9,"endColumn":17}},"message":{"text":"let criteria: any = req.query.q === 'undefined' ? '' : req.query.q ?? ''"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":4,"endLine":4,"startColumn":43,"endColumn":51}},"message":{"text":"criteria = (criteria.length <= 200) ? criteria : criteria.substring(0, 200)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":4,"endLine":4,"startColumn":5,"endColumn":13}},"message":{"text":"criteria = (criteria.length <= 200) ? criteria : criteria.substring(0, 200)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":5,"endLine":5,"startColumn":5,"endColumn":13}},"message":{"text":"criteria.replace(/\"|'|;|and|or/i, \"\")"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":6,"endLine":6,"startColumn":110,"endColumn":118}},"message":{"text":"models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":6,"endLine":6,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)"}}}]}]}]},{"ruleId":"SQL_Injection","level":"error","message":{"text":"The application's return method executes an SQL query with query, at line 11 of data\\static\\codefixes\\dbSchemaChallenge_3.ts. The application constructs this SQL query by embedding an untrusted string into the query without proper sanitization. The concatenated string is submitted to the database, where it is parsed and executed accordingly.An attacker would be able to inject arbitrary syntax and data into the SQL query, by crafting a malicious payload and providing it via the input q; this input is then read by the return method at line 5 of data\\static\\codefixes\\dbSchemaChallenge_3.ts. This input then flows through the code, into a query and to the database server - without sanitization.This may enable an SQL Injection attack.Similarity ID: 1377352566"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":5,"endLine":5,"startColumn":70,"endColumn":71}},"message":{"text":"let criteria: any = req.query.q === 'undefined' ? '' : req.query.q ?? ''"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":5,"endLine":5,"startColumn":9,"endColumn":17}},"message":{"text":"let criteria: any = req.query.q === 'undefined' ? '' : req.query.q ?? ''"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":6,"endLine":6,"startColumn":43,"endColumn":51}},"message":{"text":"criteria = (criteria.length <= 200) ? criteria : criteria.substring(0, 200)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":6,"endLine":6,"startColumn":5,"endColumn":13}},"message":{"text":"criteria = (criteria.length <= 200) ? criteria : criteria.substring(0, 200)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":7,"endLine":7,"startColumn":9,"endColumn":17}},"message":{"text":"if (criteria.match(injectionChars)) {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":11,"endLine":11,"startColumn":110,"endColumn":118}},"message":{"text":"models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":11,"endLine":11,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":5,"endLine":5,"startColumn":70,"endColumn":71}},"message":{"text":"let criteria: any = req.query.q === 'undefined' ? '' : req.query.q ?? ''"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":5,"endLine":5,"startColumn":9,"endColumn":17}},"message":{"text":"let criteria: any = req.query.q === 'undefined' ? '' : req.query.q ?? ''"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":6,"endLine":6,"startColumn":43,"endColumn":51}},"message":{"text":"criteria = (criteria.length <= 200) ? criteria : criteria.substring(0, 200)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":6,"endLine":6,"startColumn":5,"endColumn":13}},"message":{"text":"criteria = (criteria.length <= 200) ? criteria : criteria.substring(0, 200)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":7,"endLine":7,"startColumn":9,"endColumn":17}},"message":{"text":"if (criteria.match(injectionChars)) {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":11,"endLine":11,"startColumn":110,"endColumn":118}},"message":{"text":"models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":11,"endLine":11,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)"}}}]}]}]},{"ruleId":"SQL_Injection","level":"error","message":{"text":"The application's return method executes an SQL query with query, at line 10 of data\\static\\codefixes\\unionSqlInjectionChallenge_3.ts. The application constructs this SQL query by embedding an untrusted string into the query without proper sanitization. The concatenated string is submitted to the database, where it is parsed and executed accordingly.An attacker would be able to inject arbitrary syntax and data into the SQL query, by crafting a malicious payload and providing it via the input q; this input is then read by the return method at line 3 of data\\static\\codefixes\\unionSqlInjectionChallenge_3.ts. This input then flows through the code, into a query and to the database server - without sanitization.This may enable an SQL Injection attack.Similarity ID: -1649662286"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":3,"endLine":3,"startColumn":70,"endColumn":71}},"message":{"text":"let criteria: any = req.query.q === 'undefined' ? '' : req.query.q ?? ''"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":3,"endLine":3,"startColumn":9,"endColumn":17}},"message":{"text":"let criteria: any = req.query.q === 'undefined' ? '' : req.query.q ?? ''"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":4,"endLine":4,"startColumn":43,"endColumn":51}},"message":{"text":"criteria = (criteria.length <= 200) ? criteria : criteria.substring(0, 200)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":4,"endLine":4,"startColumn":5,"endColumn":13}},"message":{"text":"criteria = (criteria.length <= 200) ? criteria : criteria.substring(0, 200)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":6,"endLine":6,"startColumn":10,"endColumn":18}},"message":{"text":"if (!criteria.startsWith(\"apple\") || !criteria.startsWith(\"orange\")) {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":6,"endLine":6,"startColumn":43,"endColumn":51}},"message":{"text":"if (!criteria.startsWith(\"apple\") || !criteria.startsWith(\"orange\")) {"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":10,"endLine":10,"startColumn":110,"endColumn":118}},"message":{"text":"models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)"}},{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":10,"endLine":10,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":3,"endLine":3,"startColumn":70,"endColumn":71}},"message":{"text":"let criteria: any = req.query.q === 'undefined' ? '' : req.query.q ?? ''"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":3,"endLine":3,"startColumn":9,"endColumn":17}},"message":{"text":"let criteria: any = req.query.q === 'undefined' ? '' : req.query.q ?? ''"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":4,"endLine":4,"startColumn":43,"endColumn":51}},"message":{"text":"criteria = (criteria.length <= 200) ? criteria : criteria.substring(0, 200)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":4,"endLine":4,"startColumn":5,"endColumn":13}},"message":{"text":"criteria = (criteria.length <= 200) ? criteria : criteria.substring(0, 200)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":6,"endLine":6,"startColumn":10,"endColumn":18}},"message":{"text":"if (!criteria.startsWith(\"apple\") || !criteria.startsWith(\"orange\")) {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":6,"endLine":6,"startColumn":43,"endColumn":51}},"message":{"text":"if (!criteria.startsWith(\"apple\") || !criteria.startsWith(\"orange\")) {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":10,"endLine":10,"startColumn":110,"endColumn":118}},"message":{"text":"models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts","uriBaseId":"%SRCROOT%","index":12},"region":{"startLine":10,"endLine":10,"startColumn":22,"endColumn":27}},"message":{"text":"models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)"}}}]}]}]},{"ruleId":"Reflected_XSS","level":"error","message":{"text":"The method }).then embeds untrusted data in generated output with send, at line 17 of routes\\recycles.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by simply providing modified data in the user input id, which is read by the exports.getRecycleItem method at line 14 of routes\\recycles.ts. This input then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Reflected Cross-Site Scripting (XSS) attack.Similarity ID: -1938800321"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"routes/recycles.ts","uriBaseId":"%SRCROOT%","index":13},"region":{"startLine":14,"endLine":14,"startColumn":33,"endColumn":35}},"message":{"text":"id: JSON.parse(req.params.id)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/recycles.ts","uriBaseId":"%SRCROOT%","index":13},"region":{"startLine":14,"endLine":14,"startColumn":16,"endColumn":21}},"message":{"text":"id: JSON.parse(req.params.id)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/recycles.ts","uriBaseId":"%SRCROOT%","index":13},"region":{"startLine":14,"endLine":14,"startColumn":9,"endColumn":10}},"message":{"text":"id: JSON.parse(req.params.id)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/recycles.ts","uriBaseId":"%SRCROOT%","index":13},"region":{"startLine":13,"endLine":13,"startColumn":10,"endColumn":11}},"message":{"text":"where: {"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/recycles.ts","uriBaseId":"%SRCROOT%","index":13},"region":{"startLine":12,"endLine":12,"startColumn":16,"endColumn":23}},"message":{"text":"RecycleModel.findAll({"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/recycles.ts","uriBaseId":"%SRCROOT%","index":13},"region":{"startLine":16,"endLine":16,"startColumn":12,"endColumn":19}},"message":{"text":"}).then((Recycle) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/recycles.ts","uriBaseId":"%SRCROOT%","index":13},"region":{"startLine":17,"endLine":17,"startColumn":45,"endColumn":52}},"message":{"text":"return res.send(utils.queryResultToJson(Recycle))"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/recycles.ts","uriBaseId":"%SRCROOT%","index":13},"region":{"startLine":17,"endLine":17,"startColumn":27,"endColumn":44}},"message":{"text":"return res.send(utils.queryResultToJson(Recycle))"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/recycles.ts","uriBaseId":"%SRCROOT%","index":13},"region":{"startLine":17,"endLine":17,"startColumn":16,"endColumn":20}},"message":{"text":"return res.send(utils.queryResultToJson(Recycle))"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/recycles.ts","uriBaseId":"%SRCROOT%","index":13},"region":{"startLine":14,"endLine":14,"startColumn":33,"endColumn":35}},"message":{"text":"id: JSON.parse(req.params.id)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/recycles.ts","uriBaseId":"%SRCROOT%","index":13},"region":{"startLine":14,"endLine":14,"startColumn":16,"endColumn":21}},"message":{"text":"id: JSON.parse(req.params.id)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/recycles.ts","uriBaseId":"%SRCROOT%","index":13},"region":{"startLine":14,"endLine":14,"startColumn":9,"endColumn":10}},"message":{"text":"id: JSON.parse(req.params.id)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/recycles.ts","uriBaseId":"%SRCROOT%","index":13},"region":{"startLine":13,"endLine":13,"startColumn":10,"endColumn":11}},"message":{"text":"where: {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/recycles.ts","uriBaseId":"%SRCROOT%","index":13},"region":{"startLine":12,"endLine":12,"startColumn":16,"endColumn":23}},"message":{"text":"RecycleModel.findAll({"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/recycles.ts","uriBaseId":"%SRCROOT%","index":13},"region":{"startLine":16,"endLine":16,"startColumn":12,"endColumn":19}},"message":{"text":"}).then((Recycle) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/recycles.ts","uriBaseId":"%SRCROOT%","index":13},"region":{"startLine":17,"endLine":17,"startColumn":45,"endColumn":52}},"message":{"text":"return res.send(utils.queryResultToJson(Recycle))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/recycles.ts","uriBaseId":"%SRCROOT%","index":13},"region":{"startLine":17,"endLine":17,"startColumn":27,"endColumn":44}},"message":{"text":"return res.send(utils.queryResultToJson(Recycle))"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/recycles.ts","uriBaseId":"%SRCROOT%","index":13},"region":{"startLine":17,"endLine":17,"startColumn":16,"endColumn":20}},"message":{"text":"return res.send(utils.queryResultToJson(Recycle))"}}}]}]}]},{"ruleId":"Reflected_XSS","level":"error","message":{"text":"The method sendPostRequest embeds untrusted data in generated output with body, at line 166 of test\\cypress\\integration\\e2e\\contact.spec.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by simply providing modified data in the user input response, which is read by the cy.window method at line 137 of test\\cypress\\integration\\e2e\\contact.spec.ts. This input then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Reflected Cross-Site Scripting (XSS) attack.Similarity ID: 155506885\r\n\r\nThe method sendPostRequest embeds untrusted data in generated output with body, at line 212 of test\\cypress\\integration\\e2e\\contact.spec.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by simply providing modified data in the user input response, which is read by the cy.window method at line 187 of test\\cypress\\integration\\e2e\\contact.spec.ts. This input then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Reflected Cross-Site Scripting (XSS) attack.Similarity ID: -1616183312"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":137,"endLine":137,"startColumn":15,"endColumn":23}},"message":{"text":"const response = await fetch("}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":148,"endLine":148,"startColumn":38,"endColumn":46}},"message":{"text":"const responseJson = await response.json()"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":148,"endLine":148,"startColumn":47,"endColumn":51}},"message":{"text":"const responseJson = await response.json()"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":148,"endLine":148,"startColumn":32,"endColumn":37}},"message":{"text":"const responseJson = await response.json()"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":148,"endLine":148,"startColumn":17,"endColumn":29}},"message":{"text":"const responseJson = await response.json()"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":151,"endLine":151,"startColumn":33,"endColumn":45}},"message":{"text":"await sendPostRequest(responseJson)"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":154,"endLine":154,"startColumn":41,"endColumn":48}},"message":{"text":"async function sendPostRequest (captcha: {"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":167,"endLine":167,"startColumn":28,"endColumn":35}},"message":{"text":"captchaId: captcha.captchaId,"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":167,"endLine":167,"startColumn":36,"endColumn":45}},"message":{"text":"captchaId: captcha.captchaId,"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":167,"endLine":167,"startColumn":26,"endColumn":27}},"message":{"text":"captchaId: captcha.captchaId,"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":166,"endLine":166,"startColumn":26,"endColumn":35}},"message":{"text":"body: JSON.stringify({"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":166,"endLine":166,"startColumn":19,"endColumn":20}},"message":{"text":"body: JSON.stringify({"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":187,"endLine":187,"startColumn":17,"endColumn":25}},"message":{"text":"const response = await fetch("}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":197,"endLine":197,"startColumn":40,"endColumn":48}},"message":{"text":"const responseJson = await response.json()"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":197,"endLine":197,"startColumn":49,"endColumn":53}},"message":{"text":"const responseJson = await response.json()"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":197,"endLine":197,"startColumn":34,"endColumn":39}},"message":{"text":"const responseJson = await response.json()"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":197,"endLine":197,"startColumn":19,"endColumn":31}},"message":{"text":"const responseJson = await response.json()"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":199,"endLine":199,"startColumn":35,"endColumn":47}},"message":{"text":"await sendPostRequest(responseJson)"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":202,"endLine":202,"startColumn":43,"endColumn":50}},"message":{"text":"async function sendPostRequest (captcha: {"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":213,"endLine":213,"startColumn":28,"endColumn":35}},"message":{"text":"captchaId: captcha.captchaId,"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":213,"endLine":213,"startColumn":36,"endColumn":45}},"message":{"text":"captchaId: captcha.captchaId,"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":213,"endLine":213,"startColumn":26,"endColumn":27}},"message":{"text":"captchaId: captcha.captchaId,"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":212,"endLine":212,"startColumn":26,"endColumn":35}},"message":{"text":"body: JSON.stringify({"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":212,"endLine":212,"startColumn":19,"endColumn":20}},"message":{"text":"body: JSON.stringify({"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":137,"endLine":137,"startColumn":15,"endColumn":23}},"message":{"text":"const response = await fetch("}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":148,"endLine":148,"startColumn":38,"endColumn":46}},"message":{"text":"const responseJson = await response.json()"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":148,"endLine":148,"startColumn":47,"endColumn":51}},"message":{"text":"const responseJson = await response.json()"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":148,"endLine":148,"startColumn":32,"endColumn":37}},"message":{"text":"const responseJson = await response.json()"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":148,"endLine":148,"startColumn":17,"endColumn":29}},"message":{"text":"const responseJson = await response.json()"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":151,"endLine":151,"startColumn":33,"endColumn":45}},"message":{"text":"await sendPostRequest(responseJson)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":154,"endLine":154,"startColumn":41,"endColumn":48}},"message":{"text":"async function sendPostRequest (captcha: {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":167,"endLine":167,"startColumn":28,"endColumn":35}},"message":{"text":"captchaId: captcha.captchaId,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":167,"endLine":167,"startColumn":36,"endColumn":45}},"message":{"text":"captchaId: captcha.captchaId,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":167,"endLine":167,"startColumn":26,"endColumn":27}},"message":{"text":"captchaId: captcha.captchaId,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":166,"endLine":166,"startColumn":26,"endColumn":35}},"message":{"text":"body: JSON.stringify({"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":166,"endLine":166,"startColumn":19,"endColumn":20}},"message":{"text":"body: JSON.stringify({"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":187,"endLine":187,"startColumn":17,"endColumn":25}},"message":{"text":"const response = await fetch("}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":197,"endLine":197,"startColumn":40,"endColumn":48}},"message":{"text":"const responseJson = await response.json()"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":197,"endLine":197,"startColumn":49,"endColumn":53}},"message":{"text":"const responseJson = await response.json()"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":197,"endLine":197,"startColumn":34,"endColumn":39}},"message":{"text":"const responseJson = await response.json()"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":197,"endLine":197,"startColumn":19,"endColumn":31}},"message":{"text":"const responseJson = await response.json()"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":199,"endLine":199,"startColumn":35,"endColumn":47}},"message":{"text":"await sendPostRequest(responseJson)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":202,"endLine":202,"startColumn":43,"endColumn":50}},"message":{"text":"async function sendPostRequest (captcha: {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":213,"endLine":213,"startColumn":28,"endColumn":35}},"message":{"text":"captchaId: captcha.captchaId,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":213,"endLine":213,"startColumn":36,"endColumn":45}},"message":{"text":"captchaId: captcha.captchaId,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":213,"endLine":213,"startColumn":26,"endColumn":27}},"message":{"text":"captchaId: captcha.captchaId,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":212,"endLine":212,"startColumn":26,"endColumn":35}},"message":{"text":"body: JSON.stringify({"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/contact.spec.ts","uriBaseId":"%SRCROOT%","index":14},"region":{"startLine":212,"endLine":212,"startColumn":19,"endColumn":20}},"message":{"text":"body: JSON.stringify({"}}}]}]}]},{"ruleId":"Reflected_XSS","level":"error","message":{"text":"The method editReview embeds untrusted data in generated output with body, at line 108 of test\\cypress\\integration\\e2e\\noSql.spec.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by simply providing modified data in the user input response, which is read by the cy.window method at line 84 of test\\cypress\\integration\\e2e\\noSql.spec.ts. This input then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Reflected Cross-Site Scripting (XSS) attack.Similarity ID: 1207458228\r\n\r\nThe method sendPostRequest embeds untrusted data in generated output with body, at line 137 of test\\cypress\\integration\\e2e\\noSql.spec.ts. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.The attacker would be able to alter the returned web page by simply providing modified data in the user input response, which is read by the cy.window method at line 145 of test\\cypress\\integration\\e2e\\noSql.spec.ts. This input then flows through the code straight to the output web page, without sanitization.&nbsp;This can enable a Reflected Cross-Site Scripting (XSS) attack.Similarity ID: 1204741824"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":84,"endLine":84,"startColumn":15,"endColumn":23}},"message":{"text":"const response = await fetch("}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":94,"endLine":94,"startColumn":38,"endColumn":46}},"message":{"text":"const responseJson = await response.json()"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":94,"endLine":94,"startColumn":47,"endColumn":51}},"message":{"text":"const responseJson = await response.json()"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":94,"endLine":94,"startColumn":32,"endColumn":37}},"message":{"text":"const responseJson = await response.json()"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":94,"endLine":94,"startColumn":17,"endColumn":29}},"message":{"text":"const responseJson = await response.json()"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":95,"endLine":95,"startColumn":28,"endColumn":40}},"message":{"text":"const reviewId = responseJson.data[0]._id"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":95,"endLine":95,"startColumn":41,"endColumn":45}},"message":{"text":"const reviewId = responseJson.data[0]._id"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":95,"endLine":95,"startColumn":49,"endColumn":52}},"message":{"text":"const reviewId = responseJson.data[0]._id"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":95,"endLine":95,"startColumn":17,"endColumn":25}},"message":{"text":"const reviewId = responseJson.data[0]._id"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":96,"endLine":96,"startColumn":28,"endColumn":36}},"message":{"text":"await editReview(reviewId)"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":99,"endLine":99,"startColumn":36,"endColumn":44}},"message":{"text":"async function editReview (reviewId: string) {"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":108,"endLine":108,"startColumn":42,"endColumn":50}},"message":{"text":"body: JSON.stringify({ id: reviewId, message: 'injected' })"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":108,"endLine":108,"startColumn":40,"endColumn":41}},"message":{"text":"body: JSON.stringify({ id: reviewId, message: 'injected' })"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":108,"endLine":108,"startColumn":26,"endColumn":35}},"message":{"text":"body: JSON.stringify({ id: reviewId, message: 'injected' })"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":108,"endLine":108,"startColumn":19,"endColumn":20}},"message":{"text":"body: JSON.stringify({ id: reviewId, message: 'injected' })"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":145,"endLine":145,"startColumn":15,"endColumn":23}},"message":{"text":"const response = await fetch("}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":155,"endLine":155,"startColumn":38,"endColumn":46}},"message":{"text":"const responseJson = await response.json()"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":155,"endLine":155,"startColumn":47,"endColumn":51}},"message":{"text":"const responseJson = await response.json()"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":155,"endLine":155,"startColumn":32,"endColumn":37}},"message":{"text":"const responseJson = await response.json()"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":155,"endLine":155,"startColumn":17,"endColumn":29}},"message":{"text":"const responseJson = await response.json()"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":156,"endLine":156,"startColumn":28,"endColumn":40}},"message":{"text":"const reviewId = responseJson.data[0]._id"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":156,"endLine":156,"startColumn":41,"endColumn":45}},"message":{"text":"const reviewId = responseJson.data[0]._id"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":156,"endLine":156,"startColumn":49,"endColumn":52}},"message":{"text":"const reviewId = responseJson.data[0]._id"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":156,"endLine":156,"startColumn":17,"endColumn":25}},"message":{"text":"const reviewId = responseJson.data[0]._id"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":158,"endLine":158,"startColumn":32,"endColumn":40}},"message":{"text":"void sendPostRequest(reviewId)"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":128,"endLine":128,"startColumn":41,"endColumn":49}},"message":{"text":"async function sendPostRequest (reviewId: string) {"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":137,"endLine":137,"startColumn":42,"endColumn":50}},"message":{"text":"body: JSON.stringify({ id: reviewId })"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":137,"endLine":137,"startColumn":40,"endColumn":41}},"message":{"text":"body: JSON.stringify({ id: reviewId })"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":137,"endLine":137,"startColumn":26,"endColumn":35}},"message":{"text":"body: JSON.stringify({ id: reviewId })"}},{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":137,"endLine":137,"startColumn":19,"endColumn":20}},"message":{"text":"body: JSON.stringify({ id: reviewId })"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":84,"endLine":84,"startColumn":15,"endColumn":23}},"message":{"text":"const response = await fetch("}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":94,"endLine":94,"startColumn":38,"endColumn":46}},"message":{"text":"const responseJson = await response.json()"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":94,"endLine":94,"startColumn":47,"endColumn":51}},"message":{"text":"const responseJson = await response.json()"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":94,"endLine":94,"startColumn":32,"endColumn":37}},"message":{"text":"const responseJson = await response.json()"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":94,"endLine":94,"startColumn":17,"endColumn":29}},"message":{"text":"const responseJson = await response.json()"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":95,"endLine":95,"startColumn":28,"endColumn":40}},"message":{"text":"const reviewId = responseJson.data[0]._id"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":95,"endLine":95,"startColumn":41,"endColumn":45}},"message":{"text":"const reviewId = responseJson.data[0]._id"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":95,"endLine":95,"startColumn":49,"endColumn":52}},"message":{"text":"const reviewId = responseJson.data[0]._id"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":95,"endLine":95,"startColumn":17,"endColumn":25}},"message":{"text":"const reviewId = responseJson.data[0]._id"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":96,"endLine":96,"startColumn":28,"endColumn":36}},"message":{"text":"await editReview(reviewId)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":99,"endLine":99,"startColumn":36,"endColumn":44}},"message":{"text":"async function editReview (reviewId: string) {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":108,"endLine":108,"startColumn":42,"endColumn":50}},"message":{"text":"body: JSON.stringify({ id: reviewId, message: 'injected' })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":108,"endLine":108,"startColumn":40,"endColumn":41}},"message":{"text":"body: JSON.stringify({ id: reviewId, message: 'injected' })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":108,"endLine":108,"startColumn":26,"endColumn":35}},"message":{"text":"body: JSON.stringify({ id: reviewId, message: 'injected' })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":108,"endLine":108,"startColumn":19,"endColumn":20}},"message":{"text":"body: JSON.stringify({ id: reviewId, message: 'injected' })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":145,"endLine":145,"startColumn":15,"endColumn":23}},"message":{"text":"const response = await fetch("}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":155,"endLine":155,"startColumn":38,"endColumn":46}},"message":{"text":"const responseJson = await response.json()"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":155,"endLine":155,"startColumn":47,"endColumn":51}},"message":{"text":"const responseJson = await response.json()"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":155,"endLine":155,"startColumn":32,"endColumn":37}},"message":{"text":"const responseJson = await response.json()"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":155,"endLine":155,"startColumn":17,"endColumn":29}},"message":{"text":"const responseJson = await response.json()"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":156,"endLine":156,"startColumn":28,"endColumn":40}},"message":{"text":"const reviewId = responseJson.data[0]._id"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":156,"endLine":156,"startColumn":41,"endColumn":45}},"message":{"text":"const reviewId = responseJson.data[0]._id"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":156,"endLine":156,"startColumn":49,"endColumn":52}},"message":{"text":"const reviewId = responseJson.data[0]._id"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":156,"endLine":156,"startColumn":17,"endColumn":25}},"message":{"text":"const reviewId = responseJson.data[0]._id"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":158,"endLine":158,"startColumn":32,"endColumn":40}},"message":{"text":"void sendPostRequest(reviewId)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":128,"endLine":128,"startColumn":41,"endColumn":49}},"message":{"text":"async function sendPostRequest (reviewId: string) {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":137,"endLine":137,"startColumn":42,"endColumn":50}},"message":{"text":"body: JSON.stringify({ id: reviewId })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":137,"endLine":137,"startColumn":40,"endColumn":41}},"message":{"text":"body: JSON.stringify({ id: reviewId })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":137,"endLine":137,"startColumn":26,"endColumn":35}},"message":{"text":"body: JSON.stringify({ id: reviewId })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"test/cypress/integration/e2e/noSql.spec.ts","uriBaseId":"%SRCROOT%","index":15},"region":{"startLine":137,"endLine":137,"startColumn":19,"endColumn":20}},"message":{"text":"body: JSON.stringify({ id: reviewId })"}}}]}]}]},{"ruleId":"Insecure_Storage_of_Sensitive_Data","level":"error","message":{"text":"The application takes&nbsp;sensitive, personal data&nbsp;TernaryExpr, found at line 158 of routes\\order.ts, and stores it in an unprotected manner, without encryption, to insert at line 155 of routes\\order.ts.Similarity ID: 31335699\r\n\r\nThe application takes&nbsp;sensitive, personal data&nbsp;addressId, found at line 158 of routes\\order.ts, and stores it in an unprotected manner, without encryption, to insert at line 155 of routes\\order.ts.Similarity ID: 546856148\r\n\r\nThe application takes&nbsp;sensitive, personal data&nbsp;authenticatedUsers, found at line 40 of routes\\order.ts, and stores it in an unprotected manner, without encryption, to insert at line 155 of routes\\order.ts.Similarity ID: -1729578878"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":158,"endLine":158,"startColumn":46,"endColumn":47}},"message":{"text":"addressId: req.body.orderDetails ? req.body.orderDetails.addressId : null,"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":158,"endLine":158,"startColumn":22,"endColumn":23}},"message":{"text":"addressId: req.body.orderDetails ? req.body.orderDetails.addressId : null,"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":155,"endLine":155,"startColumn":21,"endColumn":27}},"message":{"text":"db.orders.insert({"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":158,"endLine":158,"startColumn":70,"endColumn":79}},"message":{"text":"addressId: req.body.orderDetails ? req.body.orderDetails.addressId : null,"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":158,"endLine":158,"startColumn":22,"endColumn":23}},"message":{"text":"addressId: req.body.orderDetails ? req.body.orderDetails.addressId : null,"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":155,"endLine":155,"startColumn":21,"endColumn":27}},"message":{"text":"db.orders.insert({"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":40,"endLine":40,"startColumn":37,"endColumn":55}},"message":{"text":"const customer = security.authenticatedUsers.from(req)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":40,"endLine":40,"startColumn":56,"endColumn":60}},"message":{"text":"const customer = security.authenticatedUsers.from(req)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":40,"endLine":40,"startColumn":17,"endColumn":25}},"message":{"text":"const customer = security.authenticatedUsers.from(req)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":41,"endLine":41,"startColumn":52,"endColumn":60}},"message":{"text":"const email = customer ? customer.data ? customer.data.email : '' : ''"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":41,"endLine":41,"startColumn":61,"endColumn":65}},"message":{"text":"const email = customer ? customer.data ? customer.data.email : '' : ''"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":41,"endLine":41,"startColumn":66,"endColumn":71}},"message":{"text":"const email = customer ? customer.data ? customer.data.email : '' : ''"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":41,"endLine":41,"startColumn":17,"endColumn":22}},"message":{"text":"const email = customer ? customer.data ? customer.data.email : '' : ''"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":161,"endLine":161,"startColumn":29,"endColumn":34}},"message":{"text":"email: (email ? email.replace(/[aeiou]/gi, '*') : undefined),"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":161,"endLine":161,"startColumn":35,"endColumn":42}},"message":{"text":"email: (email ? email.replace(/[aeiou]/gi, '*') : undefined),"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":161,"endLine":161,"startColumn":18,"endColumn":19}},"message":{"text":"email: (email ? email.replace(/[aeiou]/gi, '*') : undefined),"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":155,"endLine":155,"startColumn":21,"endColumn":27}},"message":{"text":"db.orders.insert({"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":158,"endLine":158,"startColumn":46,"endColumn":47}},"message":{"text":"addressId: req.body.orderDetails ? req.body.orderDetails.addressId : null,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":158,"endLine":158,"startColumn":22,"endColumn":23}},"message":{"text":"addressId: req.body.orderDetails ? req.body.orderDetails.addressId : null,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":155,"endLine":155,"startColumn":21,"endColumn":27}},"message":{"text":"db.orders.insert({"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":158,"endLine":158,"startColumn":70,"endColumn":79}},"message":{"text":"addressId: req.body.orderDetails ? req.body.orderDetails.addressId : null,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":158,"endLine":158,"startColumn":22,"endColumn":23}},"message":{"text":"addressId: req.body.orderDetails ? req.body.orderDetails.addressId : null,"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":155,"endLine":155,"startColumn":21,"endColumn":27}},"message":{"text":"db.orders.insert({"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":40,"endLine":40,"startColumn":37,"endColumn":55}},"message":{"text":"const customer = security.authenticatedUsers.from(req)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":40,"endLine":40,"startColumn":56,"endColumn":60}},"message":{"text":"const customer = security.authenticatedUsers.from(req)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":40,"endLine":40,"startColumn":17,"endColumn":25}},"message":{"text":"const customer = security.authenticatedUsers.from(req)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":41,"endLine":41,"startColumn":52,"endColumn":60}},"message":{"text":"const email = customer ? customer.data ? customer.data.email : '' : ''"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":41,"endLine":41,"startColumn":61,"endColumn":65}},"message":{"text":"const email = customer ? customer.data ? customer.data.email : '' : ''"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":41,"endLine":41,"startColumn":66,"endColumn":71}},"message":{"text":"const email = customer ? customer.data ? customer.data.email : '' : ''"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":41,"endLine":41,"startColumn":17,"endColumn":22}},"message":{"text":"const email = customer ? customer.data ? customer.data.email : '' : ''"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":161,"endLine":161,"startColumn":29,"endColumn":34}},"message":{"text":"email: (email ? email.replace(/[aeiou]/gi, '*') : undefined),"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":161,"endLine":161,"startColumn":35,"endColumn":42}},"message":{"text":"email: (email ? email.replace(/[aeiou]/gi, '*') : undefined),"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":161,"endLine":161,"startColumn":18,"endColumn":19}},"message":{"text":"email: (email ? email.replace(/[aeiou]/gi, '*') : undefined),"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/order.ts","uriBaseId":"%SRCROOT%","index":16},"region":{"startLine":155,"endLine":155,"startColumn":21,"endColumn":27}},"message":{"text":"db.orders.insert({"}}}]}]}]},{"ruleId":"Insecure_Storage_of_Sensitive_Data","level":"error","message":{"text":"The application takes&nbsp;sensitive, personal data&nbsp;authenticatedUsers, found at line 17 of routes\\likeProductReviews.ts, and stores it in an unprotected manner, without encryption, to update at line 41 of routes\\likeProductReviews.ts.Similarity ID: 742494762"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":17,"endLine":17,"startColumn":27,"endColumn":45}},"message":{"text":"const user = security.authenticatedUsers.from(req)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":17,"endLine":17,"startColumn":46,"endColumn":50}},"message":{"text":"const user = security.authenticatedUsers.from(req)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":17,"endLine":17,"startColumn":11,"endColumn":15}},"message":{"text":"const user = security.authenticatedUsers.from(req)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":33,"endLine":33,"startColumn":32,"endColumn":36}},"message":{"text":"likedBy.push(user.data.email)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":33,"endLine":33,"startColumn":37,"endColumn":41}},"message":{"text":"likedBy.push(user.data.email)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":33,"endLine":33,"startColumn":42,"endColumn":47}},"message":{"text":"likedBy.push(user.data.email)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":33,"endLine":33,"startColumn":27,"endColumn":31}},"message":{"text":"likedBy.push(user.data.email)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":33,"endLine":33,"startColumn":19,"endColumn":26}},"message":{"text":"likedBy.push(user.data.email)"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":43,"endLine":43,"startColumn":40,"endColumn":47}},"message":{"text":"{ $set: { likedBy: likedBy } }"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":43,"endLine":43,"startColumn":38,"endColumn":39}},"message":{"text":"{ $set: { likedBy: likedBy } }"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":43,"endLine":43,"startColumn":27,"endColumn":28}},"message":{"text":"{ $set: { likedBy: likedBy } }"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":41,"endLine":41,"startColumn":30,"endColumn":36}},"message":{"text":"db.reviews.update("}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":17,"endLine":17,"startColumn":27,"endColumn":45}},"message":{"text":"const user = security.authenticatedUsers.from(req)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":17,"endLine":17,"startColumn":46,"endColumn":50}},"message":{"text":"const user = security.authenticatedUsers.from(req)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":17,"endLine":17,"startColumn":11,"endColumn":15}},"message":{"text":"const user = security.authenticatedUsers.from(req)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":33,"endLine":33,"startColumn":32,"endColumn":36}},"message":{"text":"likedBy.push(user.data.email)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":33,"endLine":33,"startColumn":37,"endColumn":41}},"message":{"text":"likedBy.push(user.data.email)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":33,"endLine":33,"startColumn":42,"endColumn":47}},"message":{"text":"likedBy.push(user.data.email)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":33,"endLine":33,"startColumn":27,"endColumn":31}},"message":{"text":"likedBy.push(user.data.email)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":33,"endLine":33,"startColumn":19,"endColumn":26}},"message":{"text":"likedBy.push(user.data.email)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":43,"endLine":43,"startColumn":40,"endColumn":47}},"message":{"text":"{ $set: { likedBy: likedBy } }"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":43,"endLine":43,"startColumn":38,"endColumn":39}},"message":{"text":"{ $set: { likedBy: likedBy } }"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":43,"endLine":43,"startColumn":27,"endColumn":28}},"message":{"text":"{ $set: { likedBy: likedBy } }"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/likeProductReviews.ts","uriBaseId":"%SRCROOT%","index":17},"region":{"startLine":41,"endLine":41,"startColumn":30,"endColumn":36}},"message":{"text":"db.reviews.update("}}}]}]}]},{"ruleId":"Code_Injection","level":"error","message":{"text":"The application's&nbsp;return method receives and&nbsp;dynamically executes user-controlled code using&nbsp;id,&nbsp;at line 18 of routes\\trackOrder.ts. This could enable an attacker to inject and run arbitrary code.The attacker can inject the executed code via user input,&nbsp;id, which is retrieved by the application in the return method, at line 15 of routes\\trackOrder.ts.Similarity ID: -1481752155\r\n\r\nThe application's&nbsp;return method receives and&nbsp;dynamically executes user-controlled code using&nbsp;id,&nbsp;at line 18 of routes\\trackOrder.ts. This could enable an attacker to inject and run arbitrary code.The attacker can inject the executed code via user input,&nbsp;id, which is retrieved by the application in the return method, at line 15 of routes\\trackOrder.ts.Similarity ID: 1075686872"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"routes/trackOrder.ts","uriBaseId":"%SRCROOT%","index":18},"region":{"startLine":15,"endLine":15,"startColumn":107,"endColumn":109}},"message":{"text":"const id = utils.disableOnContainerEnv() ? String(req.params.id).replace(/[^\\w-]+/g, '') : req.params.id"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/trackOrder.ts","uriBaseId":"%SRCROOT%","index":18},"region":{"startLine":15,"endLine":15,"startColumn":11,"endColumn":13}},"message":{"text":"const id = utils.disableOnContainerEnv() ? String(req.params.id).replace(/[^\\w-]+/g, '') : req.params.id"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/trackOrder.ts","uriBaseId":"%SRCROOT%","index":18},"region":{"startLine":18,"endLine":18,"startColumn":51,"endColumn":53}},"message":{"text":"db.orders.find({ $where: `this.orderId === '${id}'` }).then((order: any) => {"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/trackOrder.ts","uriBaseId":"%SRCROOT%","index":18},"region":{"startLine":15,"endLine":15,"startColumn":66,"endColumn":68}},"message":{"text":"const id = utils.disableOnContainerEnv() ? String(req.params.id).replace(/[^\\w-]+/g, '') : req.params.id"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/trackOrder.ts","uriBaseId":"%SRCROOT%","index":18},"region":{"startLine":15,"endLine":15,"startColumn":48,"endColumn":54}},"message":{"text":"const id = utils.disableOnContainerEnv() ? String(req.params.id).replace(/[^\\w-]+/g, '') : req.params.id"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/trackOrder.ts","uriBaseId":"%SRCROOT%","index":18},"region":{"startLine":15,"endLine":15,"startColumn":70,"endColumn":77}},"message":{"text":"const id = utils.disableOnContainerEnv() ? String(req.params.id).replace(/[^\\w-]+/g, '') : req.params.id"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/trackOrder.ts","uriBaseId":"%SRCROOT%","index":18},"region":{"startLine":15,"endLine":15,"startColumn":11,"endColumn":13}},"message":{"text":"const id = utils.disableOnContainerEnv() ? String(req.params.id).replace(/[^\\w-]+/g, '') : req.params.id"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/trackOrder.ts","uriBaseId":"%SRCROOT%","index":18},"region":{"startLine":18,"endLine":18,"startColumn":51,"endColumn":53}},"message":{"text":"db.orders.find({ $where: `this.orderId === '${id}'` }).then((order: any) => {"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/trackOrder.ts","uriBaseId":"%SRCROOT%","index":18},"region":{"startLine":15,"endLine":15,"startColumn":107,"endColumn":109}},"message":{"text":"const id = utils.disableOnContainerEnv() ? String(req.params.id).replace(/[^\\w-]+/g, '') : req.params.id"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/trackOrder.ts","uriBaseId":"%SRCROOT%","index":18},"region":{"startLine":15,"endLine":15,"startColumn":11,"endColumn":13}},"message":{"text":"const id = utils.disableOnContainerEnv() ? String(req.params.id).replace(/[^\\w-]+/g, '') : req.params.id"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/trackOrder.ts","uriBaseId":"%SRCROOT%","index":18},"region":{"startLine":18,"endLine":18,"startColumn":51,"endColumn":53}},"message":{"text":"db.orders.find({ $where: `this.orderId === '${id}'` }).then((order: any) => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/trackOrder.ts","uriBaseId":"%SRCROOT%","index":18},"region":{"startLine":15,"endLine":15,"startColumn":66,"endColumn":68}},"message":{"text":"const id = utils.disableOnContainerEnv() ? String(req.params.id).replace(/[^\\w-]+/g, '') : req.params.id"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/trackOrder.ts","uriBaseId":"%SRCROOT%","index":18},"region":{"startLine":15,"endLine":15,"startColumn":48,"endColumn":54}},"message":{"text":"const id = utils.disableOnContainerEnv() ? String(req.params.id).replace(/[^\\w-]+/g, '') : req.params.id"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/trackOrder.ts","uriBaseId":"%SRCROOT%","index":18},"region":{"startLine":15,"endLine":15,"startColumn":70,"endColumn":77}},"message":{"text":"const id = utils.disableOnContainerEnv() ? String(req.params.id).replace(/[^\\w-]+/g, '') : req.params.id"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/trackOrder.ts","uriBaseId":"%SRCROOT%","index":18},"region":{"startLine":15,"endLine":15,"startColumn":11,"endColumn":13}},"message":{"text":"const id = utils.disableOnContainerEnv() ? String(req.params.id).replace(/[^\\w-]+/g, '') : req.params.id"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/trackOrder.ts","uriBaseId":"%SRCROOT%","index":18},"region":{"startLine":18,"endLine":18,"startColumn":51,"endColumn":53}},"message":{"text":"db.orders.find({ $where: `this.orderId === '${id}'` }).then((order: any) => {"}}}]}]}]},{"ruleId":"Code_Injection","level":"error","message":{"text":"The application's&nbsp;return method receives and&nbsp;dynamically executes user-controlled code using&nbsp;id,&nbsp;at line 34 of routes\\showProductReviews.ts. This could enable an attacker to inject and run arbitrary code.The attacker can inject the executed code via user input,&nbsp;id, which is retrieved by the application in the return method, at line 30 of routes\\showProductReviews.ts.Similarity ID: 1563193812"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"routes/showProductReviews.ts","uriBaseId":"%SRCROOT%","index":19},"region":{"startLine":30,"endLine":30,"startColumn":83,"endColumn":85}},"message":{"text":"const id = utils.disableOnContainerEnv() ? Number(req.params.id) : req.params.id"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/showProductReviews.ts","uriBaseId":"%SRCROOT%","index":19},"region":{"startLine":30,"endLine":30,"startColumn":11,"endColumn":13}},"message":{"text":"const id = utils.disableOnContainerEnv() ? Number(req.params.id) : req.params.id"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/showProductReviews.ts","uriBaseId":"%SRCROOT%","index":19},"region":{"startLine":34,"endLine":34,"startColumn":52,"endColumn":54}},"message":{"text":"db.reviews.find({ $where: 'this.product == ' + id }).then((reviews: Review[]) => {"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/showProductReviews.ts","uriBaseId":"%SRCROOT%","index":19},"region":{"startLine":30,"endLine":30,"startColumn":83,"endColumn":85}},"message":{"text":"const id = utils.disableOnContainerEnv() ? Number(req.params.id) : req.params.id"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/showProductReviews.ts","uriBaseId":"%SRCROOT%","index":19},"region":{"startLine":30,"endLine":30,"startColumn":11,"endColumn":13}},"message":{"text":"const id = utils.disableOnContainerEnv() ? Number(req.params.id) : req.params.id"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/showProductReviews.ts","uriBaseId":"%SRCROOT%","index":19},"region":{"startLine":34,"endLine":34,"startColumn":52,"endColumn":54}},"message":{"text":"db.reviews.find({ $where: 'this.product == ' + id }).then((reviews: Review[]) => {"}}}]}]}]},{"ruleId":"Client_Dynamic_File_Inclusion","level":"error","message":{"text":"The application loads an external library or source code file using append, at line 23 of frontend\\src\\app\\Services\\photo-wall.service.ts. An attacker might be able to exploit this and cause the application to load arbitrary code.Similarity ID: 2144626422\r\n\r\nThe application loads an external library or source code file using append, at line 22 of frontend\\src\\app\\Services\\photo-wall.service.ts. An attacker might be able to exploit this and cause the application to load arbitrary code.Similarity ID: 826843620"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.html","uriBaseId":"%SRCROOT%","index":20},"region":{"startLine":58,"endLine":58,"startColumn":50,"endColumn":57}},"message":{"text":"<input formControlName=\"caption\" type=\"text\" matInput>"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.html","uriBaseId":"%SRCROOT%","index":20},"region":{"startLine":58,"endLine":58,"startColumn":44,"endColumn":49}},"message":{"text":"<input formControlName=\"caption\" type=\"text\" matInput>"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.html","uriBaseId":"%SRCROOT%","index":20},"region":{"startLine":58,"endLine":58,"startColumn":49,"endColumn":53}},"message":{"text":"<input formControlName=\"caption\" type=\"text\" matInput>"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.ts","uriBaseId":"%SRCROOT%","index":21},"region":{"startLine":75,"endLine":75,"startColumn":42,"endColumn":46}},"message":{"text":"this.photoWallService.addMemory(this.form.value.caption, this.form.value.image).subscribe(() => {"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.ts","uriBaseId":"%SRCROOT%","index":21},"region":{"startLine":75,"endLine":75,"startColumn":47,"endColumn":52}},"message":{"text":"this.photoWallService.addMemory(this.form.value.caption, this.form.value.image).subscribe(() => {"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.ts","uriBaseId":"%SRCROOT%","index":21},"region":{"startLine":75,"endLine":75,"startColumn":53,"endColumn":60}},"message":{"text":"this.photoWallService.addMemory(this.form.value.caption, this.form.value.image).subscribe(() => {"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/Services/photo-wall.service.ts","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":20,"endLine":20,"startColumn":14,"endColumn":21}},"message":{"text":"addMemory (caption: string, image: File) {"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/Services/photo-wall.service.ts","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":23,"endLine":23,"startColumn":32,"endColumn":39}},"message":{"text":"postData.append('caption', caption)"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/Services/photo-wall.service.ts","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":23,"endLine":23,"startColumn":14,"endColumn":20}},"message":{"text":"postData.append('caption', caption)"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.html","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":58,"endLine":58,"startColumn":50,"endColumn":57}},"message":{"text":"<input formControlName=\"caption\" type=\"text\" matInput>"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.html","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":58,"endLine":58,"startColumn":44,"endColumn":49}},"message":{"text":"<input formControlName=\"caption\" type=\"text\" matInput>"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.html","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":58,"endLine":58,"startColumn":49,"endColumn":53}},"message":{"text":"<input formControlName=\"caption\" type=\"text\" matInput>"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.ts","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":75,"endLine":75,"startColumn":42,"endColumn":46}},"message":{"text":"this.photoWallService.addMemory(this.form.value.caption, this.form.value.image).subscribe(() => {"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.ts","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":75,"endLine":75,"startColumn":47,"endColumn":52}},"message":{"text":"this.photoWallService.addMemory(this.form.value.caption, this.form.value.image).subscribe(() => {"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.ts","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":75,"endLine":75,"startColumn":53,"endColumn":60}},"message":{"text":"this.photoWallService.addMemory(this.form.value.caption, this.form.value.image).subscribe(() => {"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/Services/photo-wall.service.ts","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":20,"endLine":20,"startColumn":14,"endColumn":21}},"message":{"text":"addMemory (caption: string, image: File) {"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/Services/photo-wall.service.ts","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":22,"endLine":22,"startColumn":37,"endColumn":44}},"message":{"text":"postData.append('image', image, caption)"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/Services/photo-wall.service.ts","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":22,"endLine":22,"startColumn":14,"endColumn":20}},"message":{"text":"postData.append('image', image, caption)"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.html","uriBaseId":"%SRCROOT%","index":20},"region":{"startLine":58,"endLine":58,"startColumn":50,"endColumn":57}},"message":{"text":"<input formControlName=\"caption\" type=\"text\" matInput>"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.html","uriBaseId":"%SRCROOT%","index":20},"region":{"startLine":58,"endLine":58,"startColumn":44,"endColumn":49}},"message":{"text":"<input formControlName=\"caption\" type=\"text\" matInput>"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.html","uriBaseId":"%SRCROOT%","index":20},"region":{"startLine":58,"endLine":58,"startColumn":49,"endColumn":53}},"message":{"text":"<input formControlName=\"caption\" type=\"text\" matInput>"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.ts","uriBaseId":"%SRCROOT%","index":21},"region":{"startLine":75,"endLine":75,"startColumn":42,"endColumn":46}},"message":{"text":"this.photoWallService.addMemory(this.form.value.caption, this.form.value.image).subscribe(() => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.ts","uriBaseId":"%SRCROOT%","index":21},"region":{"startLine":75,"endLine":75,"startColumn":47,"endColumn":52}},"message":{"text":"this.photoWallService.addMemory(this.form.value.caption, this.form.value.image).subscribe(() => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.ts","uriBaseId":"%SRCROOT%","index":21},"region":{"startLine":75,"endLine":75,"startColumn":53,"endColumn":60}},"message":{"text":"this.photoWallService.addMemory(this.form.value.caption, this.form.value.image).subscribe(() => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/Services/photo-wall.service.ts","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":20,"endLine":20,"startColumn":14,"endColumn":21}},"message":{"text":"addMemory (caption: string, image: File) {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/Services/photo-wall.service.ts","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":23,"endLine":23,"startColumn":32,"endColumn":39}},"message":{"text":"postData.append('caption', caption)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/Services/photo-wall.service.ts","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":23,"endLine":23,"startColumn":14,"endColumn":20}},"message":{"text":"postData.append('caption', caption)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.html","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":58,"endLine":58,"startColumn":50,"endColumn":57}},"message":{"text":"<input formControlName=\"caption\" type=\"text\" matInput>"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.html","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":58,"endLine":58,"startColumn":44,"endColumn":49}},"message":{"text":"<input formControlName=\"caption\" type=\"text\" matInput>"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.html","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":58,"endLine":58,"startColumn":49,"endColumn":53}},"message":{"text":"<input formControlName=\"caption\" type=\"text\" matInput>"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.ts","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":75,"endLine":75,"startColumn":42,"endColumn":46}},"message":{"text":"this.photoWallService.addMemory(this.form.value.caption, this.form.value.image).subscribe(() => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.ts","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":75,"endLine":75,"startColumn":47,"endColumn":52}},"message":{"text":"this.photoWallService.addMemory(this.form.value.caption, this.form.value.image).subscribe(() => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/photo-wall/photo-wall.component.ts","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":75,"endLine":75,"startColumn":53,"endColumn":60}},"message":{"text":"this.photoWallService.addMemory(this.form.value.caption, this.form.value.image).subscribe(() => {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/Services/photo-wall.service.ts","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":20,"endLine":20,"startColumn":14,"endColumn":21}},"message":{"text":"addMemory (caption: string, image: File) {"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/Services/photo-wall.service.ts","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":22,"endLine":22,"startColumn":37,"endColumn":44}},"message":{"text":"postData.append('image', image, caption)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/Services/photo-wall.service.ts","uriBaseId":"%SRCROOT%","index":22},"region":{"startLine":22,"endLine":22,"startColumn":14,"endColumn":20}},"message":{"text":"postData.append('image', image, caption)"}}}]}]}]},{"ruleId":"Angular_Client_Stored_DOM_XSS","level":"error","message":{"text":"The method &lt;!-- embeds untrusted data in generated output with lastLoginIp, at line 8 of frontend\\src\\app\\last-login-ip\\last-login-ip.component.html. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.Similarity ID: -1564184122"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.ts","uriBaseId":"%SRCROOT%","index":23},"region":{"startLine":31,"endLine":31,"startColumn":32,"endColumn":39}},"message":{"text":"const token = localStorage.getItem('token')"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.ts","uriBaseId":"%SRCROOT%","index":23},"region":{"startLine":31,"endLine":31,"startColumn":11,"endColumn":16}},"message":{"text":"const token = localStorage.getItem('token')"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.ts","uriBaseId":"%SRCROOT%","index":23},"region":{"startLine":33,"endLine":33,"startColumn":27,"endColumn":32}},"message":{"text":"payload = jwtDecode(token)"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.ts","uriBaseId":"%SRCROOT%","index":23},"region":{"startLine":33,"endLine":33,"startColumn":17,"endColumn":26}},"message":{"text":"payload = jwtDecode(token)"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.ts","uriBaseId":"%SRCROOT%","index":23},"region":{"startLine":33,"endLine":33,"startColumn":7,"endColumn":14}},"message":{"text":"payload = jwtDecode(token)"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.ts","uriBaseId":"%SRCROOT%","index":23},"region":{"startLine":36,"endLine":36,"startColumn":77,"endColumn":84}},"message":{"text":"this.lastLoginIp = this.sanitizer.bypassSecurityTrustHtml(`<small>${payload.data.lastLoginIp}</small>`)"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.ts","uriBaseId":"%SRCROOT%","index":23},"region":{"startLine":36,"endLine":36,"startColumn":85,"endColumn":89}},"message":{"text":"this.lastLoginIp = this.sanitizer.bypassSecurityTrustHtml(`<small>${payload.data.lastLoginIp}</small>`)"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.ts","uriBaseId":"%SRCROOT%","index":23},"region":{"startLine":36,"endLine":36,"startColumn":90,"endColumn":101}},"message":{"text":"this.lastLoginIp = this.sanitizer.bypassSecurityTrustHtml(`<small>${payload.data.lastLoginIp}</small>`)"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.ts","uriBaseId":"%SRCROOT%","index":23},"region":{"startLine":36,"endLine":36,"startColumn":43,"endColumn":66}},"message":{"text":"this.lastLoginIp = this.sanitizer.bypassSecurityTrustHtml(`<small>${payload.data.lastLoginIp}</small>`)"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.ts","uriBaseId":"%SRCROOT%","index":23},"region":{"startLine":36,"endLine":36,"startColumn":14,"endColumn":25}},"message":{"text":"this.lastLoginIp = this.sanitizer.bypassSecurityTrustHtml(`<small>${payload.data.lastLoginIp}</small>`)"}},{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.html","uriBaseId":"%SRCROOT%","index":24},"region":{"startLine":8,"endLine":8,"startColumn":91,"endColumn":102}},"message":{"text":"<p style=\"margin-bottom: 15px;\"><span translate>IP_ADDRESS</span>&nbsp;&nbsp;<span [innerHTML]=\"lastLoginIp\"></span></p>"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.ts","uriBaseId":"%SRCROOT%","index":23},"region":{"startLine":31,"endLine":31,"startColumn":32,"endColumn":39}},"message":{"text":"const token = localStorage.getItem('token')"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.ts","uriBaseId":"%SRCROOT%","index":23},"region":{"startLine":31,"endLine":31,"startColumn":11,"endColumn":16}},"message":{"text":"const token = localStorage.getItem('token')"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.ts","uriBaseId":"%SRCROOT%","index":23},"region":{"startLine":33,"endLine":33,"startColumn":27,"endColumn":32}},"message":{"text":"payload = jwtDecode(token)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.ts","uriBaseId":"%SRCROOT%","index":23},"region":{"startLine":33,"endLine":33,"startColumn":17,"endColumn":26}},"message":{"text":"payload = jwtDecode(token)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.ts","uriBaseId":"%SRCROOT%","index":23},"region":{"startLine":33,"endLine":33,"startColumn":7,"endColumn":14}},"message":{"text":"payload = jwtDecode(token)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.ts","uriBaseId":"%SRCROOT%","index":23},"region":{"startLine":36,"endLine":36,"startColumn":77,"endColumn":84}},"message":{"text":"this.lastLoginIp = this.sanitizer.bypassSecurityTrustHtml(`<small>${payload.data.lastLoginIp}</small>`)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.ts","uriBaseId":"%SRCROOT%","index":23},"region":{"startLine":36,"endLine":36,"startColumn":85,"endColumn":89}},"message":{"text":"this.lastLoginIp = this.sanitizer.bypassSecurityTrustHtml(`<small>${payload.data.lastLoginIp}</small>`)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.ts","uriBaseId":"%SRCROOT%","index":23},"region":{"startLine":36,"endLine":36,"startColumn":90,"endColumn":101}},"message":{"text":"this.lastLoginIp = this.sanitizer.bypassSecurityTrustHtml(`<small>${payload.data.lastLoginIp}</small>`)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.ts","uriBaseId":"%SRCROOT%","index":23},"region":{"startLine":36,"endLine":36,"startColumn":43,"endColumn":66}},"message":{"text":"this.lastLoginIp = this.sanitizer.bypassSecurityTrustHtml(`<small>${payload.data.lastLoginIp}</small>`)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.ts","uriBaseId":"%SRCROOT%","index":23},"region":{"startLine":36,"endLine":36,"startColumn":14,"endColumn":25}},"message":{"text":"this.lastLoginIp = this.sanitizer.bypassSecurityTrustHtml(`<small>${payload.data.lastLoginIp}</small>`)"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.html","uriBaseId":"%SRCROOT%","index":24},"region":{"startLine":8,"endLine":8,"startColumn":91,"endColumn":102}},"message":{"text":"<p style=\"margin-bottom: 15px;\"><span translate>IP_ADDRESS</span>&nbsp;&nbsp;<span [innerHTML]=\"lastLoginIp\"></span></p>"}}}]}]}]},{"ruleId":"Deserialization_of_Untrusted_Data","level":"error","message":{"text":"The serialized object orderLinesData processed in&nbsp;return in the file&nbsp;routes\\b2bOrder.ts at line&nbsp;18 is deserialized by&nbsp;safeEval in the file&nbsp;routes\\b2bOrder.ts at line&nbsp;22.Similarity ID: -1581592864"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"routes/b2bOrder.ts","uriBaseId":"%SRCROOT%","index":25},"region":{"startLine":18,"endLine":18,"startColumn":35,"endColumn":49}},"message":{"text":"const orderLinesData = body.orderLinesData || ''"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/b2bOrder.ts","uriBaseId":"%SRCROOT%","index":25},"region":{"startLine":18,"endLine":18,"startColumn":13,"endColumn":27}},"message":{"text":"const orderLinesData = body.orderLinesData || ''"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/b2bOrder.ts","uriBaseId":"%SRCROOT%","index":25},"region":{"startLine":22,"endLine":22,"startColumn":35,"endColumn":49}},"message":{"text":"vm.runInContext('safeEval(orderLinesData)', sandbox, { timeout: 2000 })"}},{"physicalLocation":{"artifactLocation":{"uri":"routes/b2bOrder.ts","uriBaseId":"%SRCROOT%","index":25},"region":{"startLine":22,"endLine":22,"startColumn":26,"endColumn":34}},"message":{"text":"vm.runInContext('safeEval(orderLinesData)', sandbox, { timeout: 2000 })"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/b2bOrder.ts","uriBaseId":"%SRCROOT%","index":25},"region":{"startLine":18,"endLine":18,"startColumn":35,"endColumn":49}},"message":{"text":"const orderLinesData = body.orderLinesData || ''"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/b2bOrder.ts","uriBaseId":"%SRCROOT%","index":25},"region":{"startLine":18,"endLine":18,"startColumn":13,"endColumn":27}},"message":{"text":"const orderLinesData = body.orderLinesData || ''"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/b2bOrder.ts","uriBaseId":"%SRCROOT%","index":25},"region":{"startLine":22,"endLine":22,"startColumn":35,"endColumn":49}},"message":{"text":"vm.runInContext('safeEval(orderLinesData)', sandbox, { timeout: 2000 })"}}},{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/b2bOrder.ts","uriBaseId":"%SRCROOT%","index":25},"region":{"startLine":22,"endLine":22,"startColumn":26,"endColumn":34}},"message":{"text":"vm.runInContext('safeEval(orderLinesData)', sandbox, { timeout: 2000 })"}}}]}]}]},{"ruleId":"JWT_No_Signature_Verification","level":"error","message":{"text":"The JWT is not properly verified at the decode in 112 at the file routes\\verify.ts.Similarity ID: 603579391"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"routes/verify.ts","uriBaseId":"%SRCROOT%","index":26},"region":{"startLine":112,"endLine":112,"startColumn":45,"endColumn":51}},"message":{"text":"const decoded = jws.decode(token) ? jwt.decode(token) : null"}}],"codeFlows":[{"threadFlows":[{"locations":[{"location":{"physicalLocation":{"artifactLocation":{"uri":"routes/verify.ts","uriBaseId":"%SRCROOT%","index":26},"region":{"startLine":112,"endLine":112,"startColumn":45,"endColumn":51}},"message":{"text":"const decoded = jws.decode(token) ? jwt.decode(token) : null"}}}]}]}]}],"artifacts":[{"location":{"uri":"data/static/codefixes/loginAdminChallenge_1.ts"},"length":17},{"location":{"uri":"routes/verify.ts"},"length":6},{"location":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.html"},"length":11},{"location":{"uri":"frontend/src/app/last-login-ip/last-login-ip.component.ts"},"length":7},{"location":{"uri":"routes/login.ts"},"length":17},{"location":{"uri":"frontend/src/app/photo-wall/photo-wall.component.html"},"length":7},{"location":{"uri":"routes/likeProductReviews.ts"},"length":18},{"location":{"uri":"routes/recycles.ts"},"length":2},{"location":{"uri":"routes/showProductReviews.ts"},"length":2},{"location":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_1.ts"},"length":13},{"location":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_2_correct.ts"},"length":13},{"location":{"uri":"routes/vulnCodeFixes.ts"},"length":12},{"location":{"uri":"data/static/codefixes/unionSqlInjectionChallenge_3.ts"},"length":13},{"location":{"uri":"data/static/codefixes/dbSchemaChallenge_2_correct.ts"},"length":13},{"location":{"uri":"data/static/codefixes/dbSchemaChallenge_3.ts"},"length":13},{"location":{"uri":"routes/search.ts"},"length":13},{"location":{"uri":"data/static/codefixes/loginBenderChallenge_1.ts"},"length":17},{"location":{"uri":"routes/order.ts"},"length":1},{"location":{"uri":"data/static/codefixes/dbSchemaChallenge_1.ts"},"length":13},{"location":{"uri":"routes/vulnCodeSnippet.ts"},"length":12},{"location":{"uri":"frontend/src/app/Services/photo-wall.service.ts"},"length":7},{"location":{"uri":"data/static/codefixes/loginJimChallenge_4.ts"},"length":17},{"location":{"uri":"test/cypress/integration/e2e/noSql.spec.ts"},"length":8},{"location":{"uri":"frontend/src/app/photo-wall/photo-wall.component.ts"},"length":4},{"location":{"uri":"test/cypress/integration/e2e/contact.spec.ts"},"length":8},{"location":{"uri":"routes/b2bOrder.ts"},"length":14},{"location":{"uri":"routes/trackOrder.ts"},"length":2}]}]}